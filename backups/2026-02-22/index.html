<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Sorveteria Itapolitana em Cajuru, Santa Cruz da EsperanÃ§a e CÃ¡ssia dos Coqueiros. Sorvetes artesanais, picolÃ©s e aÃ§aÃ­ desde 2007.">
<meta name="theme-color" content="#1565C0">
<title>Sorveteria Itapolitana â€“ Cajuru/SP</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900;1000&family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px;-webkit-text-size-adjust:100%}
body{font-family:'Nunito','Inter',-apple-system,BlinkMacSystemFont,sans-serif;background-color:#FFF8F0;color:#1A0A00;line-height:1.5;min-height:100vh;position:relative;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
body::before{content:'';position:fixed;inset:0;background-image:url('images/logo.png');background-repeat:repeat;background-size:110px 110px;opacity:0.35;pointer-events:none;z-index:0}
body>*{position:relative;z-index:1}
a{text-decoration:none;color:inherit}
button{font-family:inherit;cursor:pointer;border:none}
img{max-width:100%;display:block}

/* ADMIN BAR */
.admin-bar{background:#2D0A0A;text-align:center;padding:5px 12px}
.admin-bar a{color:#FF6B35;font-weight:700;font-size:11px;letter-spacing:.5px;text-transform:uppercase}
.admin-bar a:hover{color:#F9FAFB}

/* BARRA DE PROMOÃ‡ÃƒO NO TOPO */
.promo-top-bar{display:none;background:linear-gradient(135deg,#E8000D,#FF6B35,#FFD600);color:#1A0A00;text-align:center;padding:0;cursor:pointer;text-decoration:none;position:relative;overflow:hidden}
.promo-top-bar.show{display:block}
.promo-top-bar-inner{display:flex;align-items:center;justify-content:center;gap:10px;padding:11px 40px 11px 16px;position:relative;z-index:1}
.promo-top-bar-titulo{font-size:clamp(13px,3.5vw,16px);font-weight:900;letter-spacing:.3px;text-transform:uppercase}
.promo-top-bar-sub{font-size:clamp(11px,3vw,13px);font-weight:700;opacity:.85}
.promo-top-bar-cta{background:rgba(0,0,0,.18);border-radius:20px;padding:4px 12px;font-size:12px;font-weight:900;white-space:nowrap;flex-shrink:0}
.promo-top-bar-close{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:rgba(0,0,0,.2);border:none;border-radius:50%;width:26px;height:26px;color:#1A0A00;font-size:13px;font-weight:900;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:2}
@keyframes shimmer{0%{background-position:-200% center}100%{background-position:200% center}}
.promo-top-bar::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,transparent 0%,rgba(255,255,255,.25) 50%,transparent 100%);background-size:200% 100%;animation:shimmer 2.5s infinite}

/* HEADER */
.header{background:linear-gradient(135deg,#FFFDF9,#FFF3E0);border-bottom:2px solid #FF6B35;padding:12px 16px;position:sticky;top:0;z-index:100;box-shadow:0 2px 12px rgba(255,107,53,.18);isolation:isolate}
.header-inner{max-width:960px;margin:0 auto;display:flex;flex-direction:column;gap:10px}
.brand{display:flex;align-items:center;gap:10px}
.brand-icon{width:52px;height:52px;border-radius:50%;overflow:hidden;flex-shrink:0;border:2px solid #E5E7EB;background:#fff}.brand-icon img{width:100%;height:100%;object-fit:cover}
.brand-name{font-size:16px;font-weight:900;color:#E8000D;line-height:1.1;text-shadow:1px 1px 2px rgba(0,0,0,.25);letter-spacing:.5px;text-transform:uppercase}
.brand-sub{font-size:11px;color:#7B2D8B;font-weight:700;letter-spacing:.3px}
.header-nav{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;width:100%}
.nav-btn{display:flex;align-items:center;justify-content:center;gap:5px;padding:10px 6px;border-radius:10px;font-size:12px;font-weight:700;min-height:44px;transition:opacity .15s,transform .1s;white-space:nowrap;width:100%;text-align:center}
.nav-btn:active{transform:scale(.97);opacity:.9}
.nav-purple{background:linear-gradient(135deg,#1A73E8,#0D47A1);color:#fff;box-shadow:0 2px 8px rgba(26,115,232,.4)}
.nav-orange{background:linear-gradient(135deg,#FF3D00,#BF360C);color:#fff;box-shadow:0 2px 8px rgba(255,61,0,.4)}
.nav-green{background:linear-gradient(135deg,#00C853,#1B5E20);color:#fff;box-shadow:0 2px 8px rgba(0,200,83,.4)}
.nav-yellow{background:linear-gradient(135deg,#FFB300,#E65100);color:#fff;box-shadow:0 2px 8px rgba(255,179,0,.4)}
/* FAIXA REGIONAL */
.regional{background:linear-gradient(135deg,#FF6B35,#E8000D,#7B2D8B);color:#fff;text-align:center;padding:10px 16px;text-shadow:0 1px 3px rgba(0,0,0,.3)}
.regional-linha1{font-size:14px;font-weight:900;letter-spacing:.5px;text-transform:uppercase;margin-bottom:3px}
.regional-linha2{font-size:12px;font-weight:700;margin-bottom:3px}
.regional-linha3{font-size:11px;font-weight:600;opacity:.92}

/* HERO */
.hero{background:linear-gradient(160deg,#FFFDF9 0%,#FFF3E0 50%,#FCE4EC 100%);padding:24px 16px;text-align:center;border-bottom:2px solid #FF6B35;isolation:isolate}
.hero h2{font-size:22px;font-weight:900;margin-bottom:8px;line-height:1.25;letter-spacing:-.3px;color:#1A0A00}
.hero p{font-size:14px;color:#7B2D8B;font-weight:600;max-width:480px;margin:0 auto 16px;line-height:1.6;letter-spacing:.1px}
.hero-cta{display:inline-flex;align-items:center;gap:6px;background:linear-gradient(135deg,#FF6B35,#E8000D);color:#fff;padding:14px 32px;border-radius:50px;font-size:15px;font-weight:800;box-shadow:0 4px 20px rgba(232,0,13,.45);letter-spacing:.3px;text-transform:uppercase}

/* BANNER CARDÃPIO */
.cardapio-banner{width:100%;border-radius:16px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.18);margin-bottom:16px;display:none}
.cardapio-banner.show{display:block}
.cardapio-banner img{width:100%;height:auto;display:block;max-height:240px;object-fit:cover}
.cardapio-banner-vazio{width:100%;height:80px;background:linear-gradient(135deg,#FFF3E0,#FCE4EC);border:2px dashed #FF6B35;border-radius:16px;display:flex;align-items:center;justify-content:center;color:#FF6B35;font-weight:700;font-size:13px;margin-bottom:16px}
/* INFO CARDS */
.info-cards{display:grid;grid-template-columns:1fr 1fr;gap:10px;padding:16px;max-width:960px;margin:0 auto}
.info-card{background:linear-gradient(135deg,#FFFDF9,#FFF8F0);border-radius:14px;padding:14px;box-shadow:0 0 0 2px #FF6B35,0 4px 12px rgba(255,107,53,.15);isolation:isolate}
.info-icon{font-size:22px;margin-bottom:6px}
.info-title{font-size:12px;font-weight:800;color:#1A0A00;margin-bottom:3px;text-transform:uppercase;letter-spacing:.5px}
.info-text{font-size:11px;color:#7B2D8B;font-weight:700;line-height:1.4}

/* CARDÃPIO */
.cardapio{max-width:960px;margin:0 auto;padding:16px}
.cardapio-h{font-size:22px;font-weight:900;text-align:center;margin-bottom:16px;letter-spacing:-.2px;color:#1A0A00}

/* ACCORDION */
.acc{border-radius:16px;overflow:hidden;margin-bottom:12px;box-shadow:0 2px 8px rgba(0,0,0,.12);isolation:isolate}
.acc-header{display:flex;align-items:center;justify-content:space-between;padding:18px 20px;cursor:pointer;user-select:none;min-height:64px;transition:filter .15s}
.acc-header:hover{filter:brightness(1.08)}
.acc-left{display:flex;align-items:center;gap:12px}
.acc-icon{font-size:28px;flex-shrink:0;background:rgba(255,255,255,.25);border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center}
.acc-title{font-size:16px;font-weight:900;color:#fff;letter-spacing:.2px}
.acc-sub{font-size:12px;color:rgba(255,255,255,.9);font-weight:600;margin-top:2px;letter-spacing:.1px}
.acc-arrow{font-size:14px;color:#fff;font-weight:900;transition:transform .3s;flex-shrink:0}
.acc.open .acc-arrow{transform:rotate(180deg)}
.acc-body{display:none;padding:16px;background:#fff;border:2px solid transparent}
.acc.open .acc-body{display:block}
/* Cores por categoria */
#acc-sorvetes>.acc-header{background:linear-gradient(135deg,#6A0DAD,#AB47BC)}
#acc-sorvetes>.acc-body{border-color:#CE93D8}
#acc-picoles>.acc-header{background:linear-gradient(135deg,#FF6B35,#E65100)}
#acc-picoles>.acc-body{border-color:#FFCC80}
#acc-acai-promo>.acc-header{background:linear-gradient(135deg,#C62828,#FF1744)}
#acc-acai-promo>.acc-body{border-color:#F48FB1}
#acc-acai>.acc-header{background:linear-gradient(135deg,#880E4F,#E91E63)}
#acc-acai>.acc-body{border-color:#EF9A9A}
#acc-milk>.acc-header{background:linear-gradient(135deg,#0288D1,#00BCD4)}
#acc-milk>.acc-body{border-color:#81D4FA}
#acc-tacas>.acc-header{background:linear-gradient(135deg,#D81B60,#F06292)}
#acc-tacas>.acc-body{border-color:#F48FB1}
#acc-tacas-p>.acc-header{background:linear-gradient(135deg,#E65100,#FFB300)}
#acc-tacas-p>.acc-body{border-color:#FFCC02}
#acc-torta>.acc-header{background:linear-gradient(135deg,#1B5E20,#43A047)}
#acc-torta>.acc-body{border-color:#A5D6A7}
#acc-iso>.acc-header{background:linear-gradient(135deg,#006064,#00BCD4)}
#acc-iso>.acc-body{border-color:#80DEEA}
#acc-sobremesas>.acc-header{background:linear-gradient(135deg,#4A148C,#9C27B0)}
#acc-sobremesas>.acc-body{border-color:#CE93D8}
#acc-enc-caixas>.acc-header{background:linear-gradient(135deg,#6A1B9A,#AB47BC)}
#acc-enc-caixas>.acc-body{border-color:#CE93D8}
#acc-enc-tortas>.acc-header{background:linear-gradient(135deg,#C62828,#F06292)}
#acc-enc-tortas>.acc-body{border-color:#F48FB1}
#acc-enc-picoles>.acc-header{background:linear-gradient(135deg,#E65100,#FFB300)}
#acc-enc-picoles>.acc-body{border-color:#FFCC02}
.enc-link-btn{display:flex;align-items:center;justify-content:center;gap:10px;background:linear-gradient(135deg,#1565C0,#0D47A1);color:#fff;border-radius:12px;padding:16px 20px;font-size:15px;font-weight:800;text-decoration:none;box-shadow:0 4px 16px rgba(21,101,192,.4);transition:transform .15s;margin:4px 0}
.enc-link-btn:hover{transform:translateY(-2px)}

/* GRID PRODUTOS (visualizaÃ§Ã£o) */
.prod-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px}
.prod-card{background:linear-gradient(135deg,#FFFDF9,#FFF8F0);border-radius:14px;overflow:hidden;text-align:center;box-shadow:0 0 0 2px #FF6B35,0 4px 12px rgba(255,107,53,.12);isolation:isolate}
.prod-card-img{width:100%;height:110px;object-fit:cover;display:block}
.prod-card-sem-foto{width:100%;height:70px;display:flex;align-items:center;justify-content:center;font-size:30px;background:linear-gradient(135deg,#FFF3E0,#FCE4EC)}
.prod-card-body{padding:10px 12px 14px}
.prod-nome{font-size:13px;font-weight:800;color:#1A0A00;margin-bottom:4px;letter-spacing:.1px;line-height:1.3}
.prod-desc{font-size:11px;color:#7B2D8B;font-weight:700;margin-bottom:8px;line-height:1.4}
.prod-preco{font-size:18px;font-weight:900;color:#E8000D;letter-spacing:-.3px}
.prod-esgotado{font-size:11px;color:#EF4444;font-weight:700;margin-top:4px}

/* BOTÃ•ES VER SABORES / COMPLEMENTOS */
.btn-sabores{display:inline-flex;align-items:center;gap:5px;margin-top:10px;padding:9px 18px;background:linear-gradient(135deg,#FF6B35,#E8000D);color:#fff;border:none;border-radius:10px;font-size:13px;font-weight:700;transition:all .15s;box-shadow:0 2px 8px rgba(232,0,13,.3)}
.btn-sabores:hover{background:linear-gradient(135deg,#E8000D,#C62828);transform:translateY(-1px);box-shadow:0 4px 12px rgba(232,0,13,.4)}
.btn-comp{display:inline-flex;align-items:center;gap:5px;margin-top:10px;padding:9px 18px;background:linear-gradient(135deg,#FF8F00,#E65100);color:#fff;border:none;border-radius:10px;font-size:13px;font-weight:700;transition:all .15s;box-shadow:0 2px 8px rgba(230,81,0,.3)}
.btn-comp:hover{background:linear-gradient(135deg,#E65100,#BF360C);transform:translateY(-1px)}

/* AÃ‡AÃ CARD */
.acai-item{background:linear-gradient(135deg,#FFFDF9,#F8F0FF);border-radius:14px;padding:14px;margin-bottom:10px;box-shadow:0 0 0 2px #7B2D8B,0 4px 12px rgba(123,45,139,.12)}
.acai-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.acai-nome{font-size:14px;font-weight:700}
.acai-preco{font-size:18px;font-weight:900;color:#E8000D}
.acai-desc{font-size:12px;color:#7B2D8B;font-weight:700;margin-bottom:8px}

/* PICOLÃ‰ ITEM */
.picole-item{background:linear-gradient(135deg,#FFFDF9,#FFF3E0);border-radius:14px;padding:14px;margin-bottom:10px;box-shadow:0 0 0 2px #FF6B35,0 4px 12px rgba(255,107,53,.12)}
.picole-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.picole-nome{font-size:14px;font-weight:700}
.picole-preco{font-size:16px;font-weight:900;color:#E8000D}

/* MODAL BOTTOM SHEET */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:500;align-items:flex-end;justify-content:center}
.modal-overlay.show{display:flex}
.modal-box{background:linear-gradient(160deg,#FFFDF9,#FFF8F0);border-radius:24px 24px 0 0;width:100%;max-width:600px;max-height:82vh;overflow-y:auto;padding:20px 16px 32px;position:relative;border-top:3px solid #FF6B35}
.modal-handle{width:40px;height:4px;background:#E5E7EB;border-radius:2px;margin:0 auto 16px}
.modal-close{position:absolute;top:16px;right:16px;background:#F3F4F6;border:none;border-radius:50%;width:36px;height:36px;font-size:18px;font-weight:700;color:#374151;display:flex;align-items:center;justify-content:center}
.modal-title{font-size:18px;font-weight:900;margin-bottom:4px}
.modal-sub{font-size:13px;color:#7B2D8B;font-weight:700;margin-bottom:16px}
.chips{display:flex;flex-wrap:wrap;gap:8px}
.chip-sabor{background:linear-gradient(135deg,#FFF3E0,#FFE0B2);color:#BF360C;border:1px solid #FFAB40;border-radius:20px;padding:6px 14px;font-size:13px;font-weight:700}
.chip-comp{background:linear-gradient(135deg,#F8F0FF,#EDE7F6);color:#6A1B9A;border:1px solid #CE93D8;border-radius:20px;padding:5px 12px;font-size:12px;font-weight:700}
.comp-group{margin-bottom:16px}
.comp-group-h{font-size:13px;font-weight:800;color:#1A0A00;margin-bottom:8px;display:flex;align-items:center;justify-content:space-between}
.comp-preco{font-size:12px;color:#E8000D;font-weight:700}

/* PROMOÃ‡ÃƒO MODAL */
.promo-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:600;align-items:center;justify-content:center;padding:16px}
.promo-overlay.show{display:flex}
.promo-box{background:linear-gradient(135deg,#FF6B35,#E8000D,#7B2D8B);border-radius:20px;padding:28px 24px;max-width:380px;width:100%;color:#fff;text-align:center;position:relative;box-shadow:0 8px 32px rgba(232,0,13,.4)}
.promo-close{position:absolute;top:12px;right:12px;background:rgba(255,255,255,.2);border:none;border-radius:50%;width:32px;height:32px;color:#fff;font-size:16px;font-weight:700;display:flex;align-items:center;justify-content:center}
.promo-icon{font-size:48px;margin-bottom:12px}
.promo-title{font-size:22px;font-weight:900;margin-bottom:8px}
.promo-desc{font-size:14px;opacity:.9;margin-bottom:20px;line-height:1.5}
.promo-timer-box{background:rgba(0,0,0,.2);border-radius:12px;padding:12px;margin-bottom:20px}
.promo-timer-lbl{font-size:11px;opacity:.8;margin-bottom:6px}
.promo-timer-val{font-size:28px;font-weight:900;letter-spacing:2px}
.promo-btn{background:linear-gradient(135deg,#FFD600,#FF8F00);color:#1A0A00;border:none;border-radius:12px;padding:13px 28px;font-size:15px;font-weight:800;width:100%;box-shadow:0 4px 12px rgba(255,214,0,.5)}

/* CHATBOT */
.chat-fab{display:none}
/* BOTÃƒO FALE CONOSCO HERO */
@keyframes pulse-chat{0%,100%{box-shadow:0 0 0 0 rgba(37,211,102,.7),0 4px 20px rgba(37,211,102,.4)}60%{box-shadow:0 0 0 14px rgba(37,211,102,0),0 4px 20px rgba(37,211,102,.4)}}
.hero-chat-btn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;border:none;border-radius:50px;padding:13px 30px;font-size:15px;font-weight:800;cursor:pointer;letter-spacing:.3px;animation:pulse-chat 2s infinite;margin-bottom:14px;box-shadow:0 4px 20px rgba(37,211,102,.5)}
.chat-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:700;align-items:flex-end;justify-content:center}
.chat-overlay.show{display:flex}
.chat-box{background:#fff;border-radius:24px 24px 0 0;width:100%;max-width:500px;height:72vh;display:flex;flex-direction:column}
.chat-hdr{background:linear-gradient(135deg,#FF6B35,#E8000D,#7B2D8B);color:#fff;padding:16px 20px;border-radius:24px 24px 0 0;display:flex;align-items:center;justify-content:space-between}
.chat-hdr h3{font-size:16px;font-weight:800}
.chat-hdr p{font-size:11px;opacity:.8}
.chat-close{background:rgba(255,255,255,.2);border:none;border-radius:50%;width:32px;height:32px;color:#fff;font-size:16px;font-weight:700;display:flex;align-items:center;justify-content:center}
.chat-msgs{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px}
.msg{max-width:80%;padding:10px 14px;border-radius:16px;font-size:13px;line-height:1.5}
.msg.bot{background:#F3F4F6;color:#111827;align-self:flex-start;border-bottom-left-radius:4px}
.msg.user{background:linear-gradient(135deg,#FF6B35,#E8000D);color:#fff;align-self:flex-end;border-bottom-right-radius:4px}
.chat-typing{background:#FFF3E0;color:#7B2D8B;font-weight:700;align-self:flex-start;padding:10px 14px;border-radius:16px;font-size:13px;display:none}
.chat-typing.show{display:block}
.chat-sugs{padding:8px 16px;display:flex;gap:8px;overflow-x:auto;border-top:1px solid #F3F4F6;scrollbar-width:none}
.chat-sugs::-webkit-scrollbar{display:none}
.sug{background:linear-gradient(135deg,#FFF3E0,#FFE0B2);color:#BF360C;border:1px solid #FFAB40;border-radius:20px;padding:6px 14px;font-size:12px;font-weight:700;white-space:nowrap;cursor:pointer;flex-shrink:0}
.chat-inp-row{padding:12px 16px;display:flex;gap:8px;border-top:1px solid #F3F4F6}
.chat-inp{flex:1;padding:10px 14px;border:1px solid #E5E7EB;border-radius:50px;font-size:14px;font-family:inherit;outline:none}
.chat-inp:focus{border-color:#FF6B35;box-shadow:0 0 0 2px rgba(255,107,53,.2)}
.chat-send{background:linear-gradient(135deg,#FF6B35,#E8000D);color:#fff;border:none;border-radius:50%;width:40px;height:40px;font-size:16px;display:flex;align-items:center;justify-content:center;flex-shrink:0}

/* PWA BANNER */
.pwa-banner{display:none;position:fixed;bottom:16px;left:16px;right:16px;max-width:420px;margin:0 auto;background:linear-gradient(135deg,#1565C0,#D32F2F);color:#fff;border-radius:16px;padding:16px;z-index:400;box-shadow:0 8px 32px rgba(21,101,192,.4);align-items:center;gap:12px}
.pwa-banner.show{display:flex}
.pwa-banner{background:linear-gradient(135deg,#FF6B35,#E8000D,#7B2D8B)}
.pwa-icon{font-size:32px;flex-shrink:0}
.pwa-text h4{font-size:14px;font-weight:800;margin-bottom:3px}
.pwa-text p{font-size:12px;opacity:.9}
.pwa-btns{display:flex;flex-direction:column;gap:6px;flex-shrink:0}
.pwa-install{background:#F9A825;color:#111;border:none;border-radius:8px;padding:8px 14px;font-size:12px;font-weight:800}
.pwa-dismiss{background:rgba(255,255,255,.2);border:none;border-radius:8px;padding:6px 14px;font-size:11px;color:#fff;font-weight:600}

/* SEÃ‡ÃƒO ENCOMENDAS NO CARDÃPIO */
#acc-encomendas>.acc-header{background:linear-gradient(135deg,#0D47A1,#1565C0)}
#acc-encomendas>.acc-body{border-color:#90CAF9}
.enc-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px;margin-bottom:14px}
.enc-card{background:linear-gradient(135deg,#E3F2FD,#BBDEFB);border-radius:14px;overflow:hidden;text-align:center;box-shadow:0 0 0 2px #1565C0,0 4px 12px rgba(21,101,192,.15);cursor:pointer;text-decoration:none;display:block;transition:transform .15s,box-shadow .15s}
.enc-card:hover{transform:translateY(-3px);box-shadow:0 0 0 2px #1565C0,0 8px 20px rgba(21,101,192,.3)}
.enc-card-icon{width:100%;height:70px;display:flex;align-items:center;justify-content:center;font-size:34px;background:linear-gradient(135deg,#1565C0,#0D47A1)}
.enc-card-body{padding:10px 12px 14px}
.enc-card-nome{font-size:13px;font-weight:800;color:#0D47A1;margin-bottom:4px;line-height:1.3}
.enc-card-desc{font-size:11px;color:#1565C0;font-weight:700;margin-bottom:6px;line-height:1.4}
.enc-card-preco{font-size:17px;font-weight:900;color:#E8000D}
.enc-card-preco-duo{font-size:11px;color:#1565C0;font-weight:700;line-height:1.5}
.enc-cta{display:flex;align-items:center;justify-content:center;gap:10px;background:linear-gradient(135deg,#1565C0,#0D47A1);color:#fff;border-radius:12px;padding:14px 20px;font-size:15px;font-weight:800;text-decoration:none;margin-top:4px;box-shadow:0 4px 16px rgba(21,101,192,.4);transition:transform .15s}
.enc-cta:hover{transform:translateY(-2px)}
.enc-picole-item{background:linear-gradient(135deg,#E3F2FD,#BBDEFB);border-radius:14px;padding:14px;margin-bottom:10px;box-shadow:0 0 0 2px #1565C0,0 4px 12px rgba(21,101,192,.12);cursor:pointer;text-decoration:none;display:block;transition:transform .15s}
.enc-picole-item:hover{transform:translateY(-2px)}
.enc-picole-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.enc-picole-nome{font-size:14px;font-weight:800;color:#0D47A1}
.enc-picole-precos{font-size:12px;color:#1565C0;font-weight:700;line-height:1.6}
.enc-picole-sabores{font-size:11px;color:#7B2D8B;font-weight:700;margin-top:4px}

/* RODAPÃ‰ */
.footer{background:linear-gradient(135deg,#2D0A0A,#5C0A5C,#7B2D8B);color:#FFFFFF;padding:32px 16px;margin-top:24px;text-align:center;position:relative;overflow:hidden}
.footer h3{color:#FFFFFF;font-size:16px;margin-bottom:16px;text-shadow:0 1px 4px rgba(0,0,0,.3);font-weight:900;letter-spacing:.3px;text-transform:uppercase}
.footer p{font-size:13px;margin-bottom:8px;line-height:1.6;font-weight:600}
.footer-copy{margin-top:24px;padding-top:16px;border-top:1px solid rgba(255,255,255,.25);font-size:12px;color:#F3E5F5;letter-spacing:.3px;font-weight:600}
.btn-admin-footer{display:inline-block;margin-top:16px;padding:8px 16px;background:rgba(255,255,255,.15);color:#FFFFFF;border-radius:8px;font-size:11px;font-weight:600;border:1px solid rgba(255,255,255,.3)}
.footer-inner{position:relative;display:flex;align-items:center;justify-content:center;gap:0}
.footer-church{width:160px;min-width:120px;flex-shrink:0;object-fit:cover;object-position:center top;border-radius:10px;opacity:.85;box-shadow:0 4px 16px rgba(0,0,0,.4)}
.footer-text{flex:1;max-width:420px;padding:0 12px;text-align:center}
@media(max-width:600px){.footer-church{width:90px;min-width:70px}.footer-inner{gap:0}}

/* DESKTOP */
@media(min-width:600px){
  .header-inner{flex-direction:row;align-items:center;justify-content:space-between}
  .header-nav{grid-template-columns:repeat(3,auto);gap:8px}
  .nav-btn{padding:10px 16px;font-size:13px}
  .info-cards{grid-template-columns:repeat(4,1fr)}
  .prod-grid{grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}
}
</style>
</head>
<body>

<!-- BARRA DE PROMOÃ‡ÃƒO NO TOPO -->
<a href="promocao.html" class="promo-top-bar" id="promo-top-bar">
  <div class="promo-top-bar-inner">
    <span style="font-size:20px">ğŸ”¥</span>
    <div>
      <div class="promo-top-bar-titulo" id="ptb-titulo">PromoÃ§Ã£o Especial!</div>
      <div class="promo-top-bar-sub" id="ptb-sub">Clique e veja a oferta completa</div>
    </div>
    <span class="promo-top-bar-cta">Ver agora â†’</span>
  </div>
  <button class="promo-top-bar-close" onclick="event.preventDefault();event.stopPropagation();fecharBarraPromo()" title="Fechar">âœ•</button>
</a>

<!-- BARRA ADMIN DISCRETA -->
<div class="admin-bar">
  <a href="gerenciar/index.html">âš™ï¸ Painel Administrativo</a>
</div>

<!-- HEADER -->
<header class="header">
  <div class="header-inner">
    <div class="brand">
      <div class="brand-icon"><img src="images/logo.png" alt="Logo Itapolitana"></div>
      <div>
        <div class="brand-name">ITAPOLITANA CAJURU</div>
        <div class="brand-sub">AÃ§aiteria &amp; Sorveteria Â· Desde 2007</div>
      </div>
    </div>
    <nav class="header-nav">
      <a href="encomendas.html" class="nav-btn nav-purple">ğŸ›’ Encomendas</a>
      <a href="promocao.html" class="nav-btn nav-orange" id="nav-promo-btn">ğŸ‰ PromoÃ§Ã£o</a>
      <a href="https://www.google.com/maps/place/Sorveteria+A%C3%A7aiteria+Itapolitana+Cajuru/@-21.2776766,-47.3071817" target="_blank" class="nav-btn nav-yellow">â­ Avalie</a>
    </nav>
  </div>
</header>

<!-- FAIXA REGIONAL -->
<div class="regional">
  <div class="regional-linha1">ğŸš« NÃ£o fazemos delivery</div>
  <div class="regional-linha2">ğŸª Encomendas: retirada somente na loja</div>
  <div class="regional-linha3">ğŸ“ Atendemos Cajuru Â· Santa Cruz da EsperanÃ§a Â· CÃ¡ssia dos Coqueiros</div>
</div>

<!-- HERO -->
<section class="hero">
  <h2>O Sorvete Mais Cremoso e Amado de Cajuru e RegiÃ£o</h2>
  <p>ProduÃ§Ã£o prÃ³pria com ingredientes selecionados. Sorvetes artesanais, picolÃ©s recheados e aÃ§aÃ­ premium desde 2007.</p>
  <button class="hero-chat-btn" onclick="abrirChat()">ğŸ’¬ Fale Conosco</button>
  <br>
  <button class="hero-cta" onclick="document.getElementById('cardapio').scrollIntoView({behavior:'smooth'})">
    ğŸ¦ Ver CardÃ¡pio Completo
  </button>
</section>
<!-- INFO CARDS -->
<div class="info-cards">
  <a href="https://www.google.com/maps/place/Sorveteria+A%C3%A7aiteria+Itapolitana+Cajuru/@-21.2776766,-47.3071817" target="_blank" class="info-card" style="text-decoration:none;color:inherit;display:block"><div class="info-icon">ğŸ“</div><div class="info-title">LocalizaÃ§Ã£o</div><div class="info-text" style="color:#4285F4;font-weight:700">PÃ§a Lgo SÃ£o Bento, 311 â€“ Cajuru/SP ğŸ—ºï¸</div></a>
  <div class="info-card"><div class="info-icon">â°</div><div class="info-title">HorÃ¡rio</div><div class="info-text">Segâ€“Dom: 10h Ã s 22h</div></div>
  <div class="info-card"><div class="info-icon">ğŸª</div><div class="info-title">Retirada</div><div class="info-text">Somente na loja</div></div>
  <div class="info-card"><div class="info-icon">ğŸ“±</div><div class="info-title">Contato</div><div class="info-text">(16) 99147-2045</div></div>
</div>

<!-- CARDÃPIO -->
<section id="cardapio" class="cardapio">
  <!-- BANNER ENQUADRADO -->
  <div class="cardapio-banner show" id="cardapio-banner">
    <img id="cardapio-banner-img" src="images/banner-cardapio.png" alt="Sorveteria Itapolitana Cajuru">
  </div>

  <!-- SORVETES -->
  <div class="acc" id="acc-sorvetes">
    <div class="acc-header" onclick="toggleAcc('acc-sorvetes')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ¦</span>
        <div><div class="acc-title">Sorvetes de Massa</div><div class="acc-sub">Casquinha, copo, cascÃ£o, cestinha Â· 36 sabores</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <div id="sorvetes-grid" class="prod-grid"></div>
      <div style="text-align:center;margin-top:14px">
        <button class="btn-sabores" onclick="abrirSabores('sorvetes','ğŸ¦ 36 Sabores de Sorvete')">ğŸ¨ Ver os 36 Sabores</button>
      </div>
    </div>
  </div>

  <!-- MILKSHAKES -->
  <div class="acc" id="acc-milk">
    <div class="acc-header" onclick="toggleAcc('acc-milk')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ¥¤</span>
        <div><div class="acc-title">Milkshakes</div><div class="acc-sub">Tradicional e Top Â· VÃ¡rios tamanhos Â· 36 sabores</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <div id="milk-grid" class="prod-grid"></div>
      <div style="text-align:center;margin-top:14px">
        <button class="btn-sabores" onclick="abrirMilkshakeSabores()">ğŸ¥¤ Ver Tamanhos e PreÃ§os</button>
      </div>
    </div>
  </div>

  <!-- TAÃ‡AS -->
  <div class="acc" id="acc-tacas">
    <div class="acc-header" onclick="toggleAcc('acc-tacas')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ¨</span>
        <div><div class="acc-title">TaÃ§as</div><div class="acc-sub">8 opÃ§Ãµes Â· Colegial, Sundae, Banana Split e mais Â· 36 sabores</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <div id="tacas-grid" class="prod-grid"></div>
      <div style="text-align:center;margin-top:14px">
        <button class="btn-sabores" onclick="abrirTacasTradicionais()">ğŸ¨ Ver as 8 TaÃ§as</button>
      </div>
    </div>
  </div>

  <!-- TAÃ‡AS PREMIUM -->
  <div class="acc" id="acc-tacas-p">
    <div class="acc-header" onclick="toggleAcc('acc-tacas-p')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ†</span>
        <div><div class="acc-title">TaÃ§as Premium (TaÃ§as Sujas)</div><div class="acc-sub">7 opÃ§Ãµes Â· PrestÃ­gio, Kit Kat, UnicÃ³rnio e mais Â· 36 sabores</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <div id="tacas-p-grid" class="prod-grid"></div>
      <div style="text-align:center;margin-top:14px">
        <button class="btn-sabores" onclick="abrirTacasSujas()">ğŸ† Ver as 7 TaÃ§as Premium</button>
      </div>
    </div>
  </div>

  <!-- AÃ‡AÃ PROMOÃ‡ÃƒO -->
  <div class="acc" id="acc-acai-promo">
    <div class="acc-header" onclick="toggleAcc('acc-acai-promo')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ›–</span>
        <div><div class="acc-title">AÃ§aÃ­ PromoÃ§Ã£o</div><div class="acc-sub">8 combos especiais Â· 400ml a 700ml</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body" id="acai-promo-body"></div>
  </div>
  <!-- AÃ‡AÃ -->
  <div class="acc" id="acc-acai">
    <div class="acc-header" onclick="toggleAcc('acc-acai')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ«</span>
        <div><div class="acc-title">AÃ§aÃ­ Artesanal</div><div class="acc-sub">Monte o seu Â· 300ml a 600ml Â· Ingredientes extras</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body" id="acai-body"></div>
  </div>

  <!-- PICOLÃ‰S -->
  <div class="acc" id="acc-picoles">
    <div class="acc-header" onclick="toggleAcc('acc-picoles')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ­</span>
        <div><div class="acc-title">PicolÃ©s</div><div class="acc-sub">5 tipos Â· Fruta, Leite, Recheado, Ninho, Eskimo</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body" id="picoles-body"></div>
  </div>

  <!-- TORTA DE SORVETE -->
  <div class="acc" id="acc-torta">
    <div class="acc-header" onclick="toggleAcc('acc-torta')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ‚</span>
        <div><div class="acc-title">Torta de Sorvete</div><div class="acc-sub">Encomende com 3 dias de antecedÃªncia Â· 36 sabores</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <div class="prod-card" style="max-width:280px" id="torta-card">
        <div id="torta-foto-area"></div>
        <div class="prod-card-body">
          <div class="prod-nome">ğŸ‚ Torta de Sorvete</div>
          <div class="prod-desc">Feita com 3 sabores Ã  sua escolha. Perfeita para festas e comemoraÃ§Ãµes.</div>
          <div class="prod-preco" id="torta-preco">R$ 100,00</div>
        </div>
      </div>
      <div style="margin-top:12px">
        <button class="btn-sabores" onclick="abrirSabores('sorvetes','ğŸ‚ Sabores para Torta de Sorvete')">ğŸ¨ Ver os 36 Sabores</button>
        <a href="encomendas.html" class="btn-comp" style="margin-left:8px">ğŸ›’ Encomendar</a>
      </div>
    </div>
  </div>

  <!-- ISOPORES DE VIAGEM -->
  <div class="acc" id="acc-iso">
    <div class="acc-header" onclick="toggleAcc('acc-iso')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ§Š</span>
        <div><div class="acc-title">Isopores de Viagem</div><div class="acc-sub">4 tamanhos Â· Leve sorvete para casa</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body" id="iso-body"></div>
  </div>
  <!-- SOBREMESAS GELADAS -->
  <div class="acc" id="acc-sobremesas">
    <div class="acc-header" onclick="toggleAcc('acc-sobremesas')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ¨</span>
        <div><div class="acc-title">Sobremesas Geladas</div><div class="acc-sub">Fundue, Petit Gateau, Sorvete Diet e mais</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body" id="sobremesas-body"></div>
  </div>

  <!-- ENCOMENDAS NO CARDÃPIO: CAIXAS -->
  <div class="acc" id="acc-enc-caixas">
    <div class="acc-header" onclick="toggleAcc('acc-enc-caixas')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ§ƒ</span>
        <div><div class="acc-title">Sorvetes em Caixa 5 e 10 Litros</div><div class="acc-sub">4 opÃ§Ãµes Â· 2 ou 3 sabores Â· Encomende com antecedÃªncia</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <a href="encomendas.html#caixas" class="enc-link-btn">ğŸ§ƒ Ver Caixas de Sorvete e Encomendar â†’</a>
    </div>
  </div>

  <!-- ENCOMENDAS NO CARDÃPIO: TORTAS -->
  <div class="acc" id="acc-enc-tortas">
    <div class="acc-header" onclick="toggleAcc('acc-enc-tortas')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ‚</span>
        <div><div class="acc-title">Tortas de Sorvete</div><div class="acc-sub">3 sabores Ã  escolha Â· Festas e comemoraÃ§Ãµes Â· Encomende com 3 dias</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <a href="encomendas.html#tortas" class="enc-link-btn">ğŸ‚ Ver Tortas de Sorvete e Encomendar â†’</a>
    </div>
  </div>

  <!-- ENCOMENDAS NO CARDÃPIO: PICOLÃ‰S -->
  <div class="acc" id="acc-enc-picoles">
    <div class="acc-header" onclick="toggleAcc('acc-enc-picoles')">
      <div class="acc-left">
        <span class="acc-icon">ğŸ­</span>
        <div><div class="acc-title">PicolÃ©s para Encomenda</div><div class="acc-sub">5 tipos Â· MÃ­n. 100 un. Â· PreÃ§os de atacado</div></div>
      </div>
      <span class="acc-arrow">â–¼</span>
    </div>
    <div class="acc-body">
      <a href="encomendas.html#picoles" class="enc-link-btn">ğŸ­ Ver PicolÃ©s e Encomendar â†’</a>
    </div>
  </div>


  <!-- COMPLEMENTOS NO CARDÃPIO -->
  <div class="acc" id="acc-complementos">
    <div class="acc-header" onclick="toggleAcc('acc-complementos')" style="background:linear-gradient(135deg,#B71C1C,#E53935,#FF5252)">
      <div class="acc-left">
        <span class="acc-icon">ğŸª</span>
        <div><div class="acc-title" style="color:#fff">Complementos para Sorvetes</div><div class="acc-sub" style="color:rgba(255,255,255,0.85)">Canudinho, Casquinha, CascÃ£o, Cestinha, Cobertura</div></div>
      </div>
      <span class="acc-arrow" style="color:#fff">â–¼</span>
    </div>
    <div class="acc-body" id="acc-body-complementos"></div>
  </div>

</section>
<!-- RODAPÃ‰ v2 -->
<footer class="footer">
  <div class="footer-inner">
    <img src="img/igreja-cajuru.jpg" alt="Igreja Matriz SÃ£o Bento â€“ Cajuru/SP" class="footer-church">
    <div class="footer-text">
      <h3>ğŸ“ Onde Estamos</h3>
      <p>PÃ§a Lgo SÃ£o Bento, 311 â€“ Centro, Cajuru/SP</p>
      <p style="font-size:12px;color:#FFD54F;font-weight:700;margin-top:-4px">â›ªï¸ Na PraÃ§a Largo SÃ£o Bento, em frente Ã  Igreja SÃ£o Bento</p>
      <p>ğŸ“ (16) 99147-2045</p>
      <p>â° Segunda a Domingo: 10h Ã s 22h</p>
      <p style="margin-top:12px;font-size:12px;color:#EF4444;font-weight:600">ğŸš« NÃ£o fazemos delivery Â· Retirada somente na loja</p>
      <a href="gerenciar/index.html" class="btn-admin-footer">âš™ï¸ Painel Administrativo</a>
      <div class="footer-copy">Â© 2007â€“2026 Sorveteria Itapolitana Â· Todos os direitos reservados</div>
      <div style="margin-top:8px;font-size:12px;color:#FFFFFF;font-weight:900;letter-spacing:.5px">Desenvolvido por SgtMissiasCaÃ§aRato</div>
    </div>
    <img src="img/igreja-cajuru.jpg" alt="Igreja Matriz SÃ£o Bento â€“ Cajuru/SP" class="footer-church">
  </div>
</footer>

<!-- MODAL SABORES -->
<div class="modal-overlay" id="modal-sabores">
  <div class="modal-box">
    <div class="modal-handle"></div>
    <button class="modal-close" onclick="fecharModal('modal-sabores')">âœ•</button>
    <div class="modal-title" id="ms-titulo">Sabores DisponÃ­veis</div>
    <div class="modal-sub">Informe o sabor desejado ao fazer seu pedido na loja</div>
    <div class="chips" id="ms-chips"></div>
  </div>
</div>

<!-- MODAL COMPLEMENTOS AÃ‡AÃ -->
<div class="modal-overlay" id="modal-comp">
  <div class="modal-box">
    <div class="modal-handle"></div>
    <button class="modal-close" onclick="fecharModal('modal-comp')">âœ•</button>
    <div class="modal-title">ğŸ« Complementos do AÃ§aÃ­</div>
    <div class="modal-sub">DisponÃ­veis para o AÃ§aÃ­ Personalizado</div>
    <div id="comp-lista"></div>
  </div>
</div>

<!-- MODAL SABORES PICOLÃ‰ -->
<div class="modal-overlay" id="modal-picole">
  <div class="modal-box">
    <div class="modal-handle"></div>
    <button class="modal-close" onclick="fecharModal('modal-picole')">âœ•</button>
    <div class="modal-title" id="mp-titulo">Sabores do PicolÃ©</div>
    <div class="modal-sub" id="mp-sub"></div>
    <div class="chips" id="mp-chips"></div>
  </div>
</div>

<!-- MODAL PROMOÃ‡ÃƒO -->
<div class="promo-overlay" id="promo-overlay">
  <div class="promo-box">
    <button class="promo-close" onclick="fecharModal('promo-overlay')">âœ•</button>
    <div class="promo-icon" id="promo-icon">ğŸ‰</div>
    <img id="promo-img" src="" alt="PromoÃ§Ã£o" style="display:none;width:100%;border-radius:12px;margin-bottom:12px;max-height:200px;object-fit:cover">
    <div class="promo-title" id="promo-title">PromoÃ§Ã£o Especial!</div>
    <div class="promo-desc" id="promo-desc">Confira nossas promoÃ§Ãµes especiais de hoje. Aproveite enquanto durar!</div>
    <div class="promo-timer-box">
      <div class="promo-timer-lbl">â³ PromoÃ§Ã£o encerra em:</div>
      <div class="promo-timer-val" id="promo-timer">00:00:00:00</div>
      <div style="font-size:10px;opacity:.7;margin-top:4px;letter-spacing:1px">DIAS &nbsp; HH &nbsp; MM &nbsp; SS</div>
    </div>
    <button class="promo-btn" id="promo-btn" onclick="abrirLinkPromo()">ğŸ’¬ Falar com a Loja</button>
  </div>
</div>

<!-- CHATBOT -->
<button class="chat-fab" onclick="abrirChat()">ğŸ’¬ Fale Conosco</button>

<div class="chat-overlay" id="chat-overlay">
  <div class="chat-box">
    <div class="chat-hdr">
      <div><h3>ğŸ’¬ Fale Conosco</h3><p>Assistente Itapolitana Â· Responde na hora</p></div>
      <button class="chat-close" onclick="fecharModal('chat-overlay')">âœ•</button>
    </div>
    <div class="chat-msgs" id="chat-msgs">
      <div class="msg bot">OlÃ¡! ğŸ‘‹ Sou o assistente da Sorveteria Itapolitana. Como posso te ajudar?</div>
    </div>
    <div class="chat-typing" id="chat-typing">Digitando...</div>
    <div class="chat-sugs">
      <button class="sug" onclick="enviarSug(this)">HorÃ¡rio</button>
      <button class="sug" onclick="enviarSug(this)">Como encomendar</button>
      <button class="sug" onclick="enviarSug(this)">Sabores</button>
      <button class="sug" onclick="enviarSug(this)">PreÃ§os</button>
      <button class="sug" onclick="enviarSug(this)">LocalizaÃ§Ã£o</button>
      <button class="sug" onclick="enviarSug(this)">PicolÃ©s</button>
    </div>
    <div class="chat-inp-row">
      <input type="text" class="chat-inp" id="chat-inp" placeholder="Digite sua pergunta..." onkeydown="if(event.key==='Enter')enviarChat()">
      <button class="chat-send" onclick="enviarChat()">â¤</button>
    </div>
  </div>
</div>

<!-- PWA BANNER -->
<div class="pwa-banner" id="pwa-banner">
  <div class="pwa-icon">ğŸ“²</div>
  <div class="pwa-text"><h4>Instalar Aplicativo</h4><p>Adicione Ã  tela inicial para acesso rÃ¡pido e promoÃ§Ãµes!</p></div>
  <div class="pwa-btns">
    <button class="pwa-install" id="pwa-btn">Instalar Agora</button>
    <button class="pwa-dismiss" onclick="document.getElementById('pwa-banner').classList.remove('show')">Agora nÃ£o</button>
  </div>
</div>

<script src="scripts/products.js"></script>
<script>
// â”€â”€ FOTOS DO PRODUTO (localStorage) â”€â”€
function getFotos(){try{return JSON.parse(localStorage.getItem('itap_fotos')||'{}');}catch(e){return {};}}
function imgCard(chave,emoji){
  const f=getFotos()[chave];
  if(f) return `<img class="prod-card-img" src="${f}" alt="foto">`;
  return `<div class="prod-card-sem-foto">${emoji||'ğŸ¦'}</div>`;
}
// â”€â”€ ACCORDION â”€â”€
function toggleAcc(id){
  const el=document.getElementById(id);
  const isOpen=el.classList.contains('open');
  // Fechar todos os accordions
  document.querySelectorAll('.acc.open').forEach(a=>a.classList.remove('open'));
  // Se estava fechado, abrir o clicado; se estava aberto, deixar fechado
  if(!isOpen) el.classList.add('open');
}

// â”€â”€ MODAL HELPERS â”€â”€
function fecharModal(id){document.getElementById(id).classList.remove('show')}
function abrirModal(id){document.getElementById(id).classList.add('show')}

// â”€â”€ RENDER SORVETES â”€â”€ (lÃª do products.js)
function renderSorvetes(){
  const g=document.getElementById('sorvetes-grid');
  const nomes={casquinha_copo:'Casquinha / Copo',copo_recheado:'Copo Recheado',cascao:'CascÃ£o',cestinha:'Cestinha'};
  const desc={casquinha_copo:'1 bola',copo_recheado:'1 bola + recheio',cascao:'Casquinha grande',cestinha:'Cestinha crocante'};
  if(produtos&&produtos.sorvetes&&produtos.sorvetes.precos){
    Object.entries(produtos.sorvetes.precos).forEach(([key,precos])=>{
      const preco=Object.values(precos)[0];
      const chave='sorvete_'+key+'_'+Object.keys(precos)[0].replace(/\s/g,'_');
      const c=document.createElement('div');c.className='prod-card';
      c.innerHTML=imgCard(chave,'ğŸ¦')+`<div class="prod-card-body"><div class="prod-nome">${nomes[key]||key}</div><div class="prod-desc">${desc[key]||''}</div><div class="prod-preco">A partir de R$ ${preco.toFixed(2).replace('.',',')}</div></div>`;
      g.appendChild(c);
    });
  }
}

// â”€â”€ RENDER MILKSHAKE â”€â”€ (lÃª do products.js)
function renderMilk(){
  const g=document.getElementById('milk-grid');
  if(produtos&&produtos.milkshake){
    const m=produtos.milkshake;
    const tipos=[];
    if(m.tradicional) Object.entries(m.tradicional).forEach(([tam,preco])=>tipos.push({nome:`Milkshake Tradicional ${tam}`,preco,chave:'milk_trad_'+tam.replace(/\s/g,'_')}));
    if(m.top) Object.entries(m.top).forEach(([tam,preco])=>tipos.push({nome:`Milkshake Top ${tam}`,preco,chave:'milk_top_'+tam.replace(/\s/g,'_')}));
    tipos.forEach(t=>{
      const c=document.createElement('div');c.className='prod-card';
      c.innerHTML=imgCard(t.chave,'ğŸ¥¤')+`<div class="prod-card-body"><div class="prod-nome">${t.nome}</div><div class="prod-preco">R$ ${t.preco.toFixed(2).replace('.',',')}</div></div>`;
      g.appendChild(c);
    });
  }
}

// â”€â”€ RENDER TAÃ‡AS â”€â”€ (lÃª do products.js)
function renderTacas(){
  const g=document.getElementById('tacas-grid');
  if(produtos&&produtos.tacas&&produtos.tacas.tradicionais){
    Object.entries(produtos.tacas.tradicionais).forEach(([nome,preco])=>{
      const chave='taca_trad_'+nome.replace(/\s/g,'_');
      const c=document.createElement('div');c.className='prod-card';
      c.innerHTML=imgCard(chave,'ğŸ¨')+`<div class="prod-card-body"><div class="prod-nome">TaÃ§a ${nome}</div><div class="prod-preco">R$ ${preco.toFixed(2).replace('.',',')}</div></div>`;
      g.appendChild(c);
    });
  }
}
// â”€â”€ RENDER TAÃ‡AS PREMIUM â”€â”€ (lÃª do products.js)
function renderTacasP(){
  const g=document.getElementById('tacas-p-grid');
  if(produtos&&produtos.tacas&&produtos.tacas.sujas){
    Object.entries(produtos.tacas.sujas).forEach(([nome,preco])=>{
      const chave='taca_suja_'+nome.replace(/\s/g,'_');
      const c=document.createElement('div');c.className='prod-card';
      c.innerHTML=imgCard(chave,'ğŸ°')+`<div class="prod-card-body"><div class="prod-nome">TaÃ§a Suja â€“ ${nome}</div><div class="prod-preco">R$ ${preco.toFixed(2).replace('.',',')}</div></div>`;
      g.appendChild(c);
    });
  }
}

// â”€â”€ RENDER AÃ‡AÃ â”€â”€ (lÃª do products.js)
// â”€â”€ RENDER AÃ‡AÃ PROMOÃ‡ÃƒO â”€â”€ (lÃª do products.js)
function renderAcaiPromo(){
  const b=document.getElementById('acai-promo-body');if(!b)return;b.innerHTML='';
  if(produtos&&produtos.acai_promocao){
    produtos.acai_promocao.forEach((p,i)=>{
      const d=document.createElement('div');d.className='acai-item';
      d.innerHTML=`<div class="acai-row"><span class="acai-nome">ğŸ›– ${p.nome}</span><span class="acai-preco">R$ ${p.preco.toFixed(2).replace('.',',')}</span></div><div class="acai-desc">${p.desc}</div>`;
      b.appendChild(d);
    });
  }
}
function renderAcai(){
  const b=document.getElementById('acai-body');b.innerHTML='';
  if(produtos&&produtos.acai&&produtos.acai.copos){
    Object.entries(produtos.acai.copos).forEach(([tam,preco])=>{
      const d=document.createElement('div');d.className='acai-item';
      d.innerHTML=`<div class="acai-row"><span class="acai-nome">ğŸ« Monte o Seu ${tam}</span><span class="acai-preco">R$ ${preco.toFixed(2).replace('.',',')}</span></div><div class="acai-desc">Todos ingredientes extras</div><button class="btn-comp" onclick="abrirComplementos()">ğŸ“ Ver Ingredientes DisponÃ­veis</button>`;
      b.appendChild(d);
    });
  }
}

// â”€â”€ RENDER PICOLÃ‰S â”€â”€ (lÃª do products.js)
const iconesPicole={frutas_agua:'ğŸ‰',leite_sem_recheio:'ğŸ¦',leite_com_recheio:'ğŸ«',leite_ninho:'â­',eskimos:'ğŸ¬'};
function renderPicoles(){
  const b=document.getElementById('picoles-body');b.innerHTML='';
  if(produtos&&produtos.picoles){
    Object.entries(produtos.picoles).forEach(([key,p])=>{
      const d=document.createElement('div');d.className='picole-item';
      const icon=iconesPicole[key]||'ğŸ­';
      d.innerHTML=`<div class="picole-row"><span class="picole-nome">${icon} ${p.nome}</span><span class="picole-preco">R$ ${p.preco_varejo.toFixed(2).replace('.',',')}</span></div><button class="btn-sabores" onclick="abrirPicole('${key}','${p.nome}')">ğŸ­ Ver Sabores DisponÃ­veis</button>`;
      b.appendChild(d);
    });
  }
}

// â”€â”€ RENDER ISOPORES DE VIAGEM â”€â”€ (lÃª do products.js)
function renderIso(){
  const b=document.getElementById('iso-body');if(!b)return;b.innerHTML='';
  if(produtos&&produtos.isopores_viagem){
    const grid=document.createElement('div');grid.className='prod-grid';
    Object.entries(produtos.isopores_viagem).forEach(([tam,preco])=>{
      const chave='isopore_'+tam.replace(/\s/g,'_');
      const d=document.createElement('div');d.className='prod-card';
      d.innerHTML=imgCard(chave,'ğŸ§Š')+`<div class="prod-card-body"><div class="prod-nome">ğŸ§Š Isopore ${tam}</div><div class="prod-desc">Leve sorvete para casa</div><div class="prod-preco">R$ ${preco.toFixed(2).replace('.',',')}</div></div>`;
      grid.appendChild(d);
    });
    b.appendChild(grid);
    const btn=document.createElement('div');btn.style='margin-top:12px';
    btn.innerHTML=`<button class="btn-sabores" onclick="abrirSabores('sorvetes','ğŸ§Š Sabores para Isopore')">ğŸ¨ Ver os 36 Sabores</button>`;
    b.appendChild(btn);
  }
}
// â”€â”€ RENDER SOBREMESAS GELADAS â”€â”€ (lÃª do products.js)
function renderSobremesas(){
  const b=document.getElementById('sobremesas-body');if(!b)return;b.innerHTML='';
  if(produtos&&produtos.sobremesas){
    const grid=document.createElement('div');grid.className='prod-grid';
    Object.entries(produtos.sobremesas).forEach(([nome,preco])=>{
      const chave='sobremesa_'+nome.replace(/\s/g,'_');
      const d=document.createElement('div');d.className='prod-card';
      d.innerHTML=imgCard(chave,'ğŸ‚')+`<div class="prod-card-body"><div class="prod-nome">ğŸ¨ ${nome}</div><div class="prod-preco">R$ ${preco.toFixed(2).replace('.',',')}</div></div>`;
      grid.appendChild(d);
    });
    b.appendChild(grid);
    const btn=document.createElement('div');btn.style='margin-top:12px';
    btn.innerHTML=`<button class="btn-sabores" onclick="abrirSabores('sorvetes','ğŸ¨ Sabores para Sobremesas')">ğŸ¨ Ver os 36 Sabores</button>`;
    b.appendChild(btn);
  }
}
// â”€â”€ ABRIR MODAL SABORES â”€â”€
function getSaboresDisponiveis(){
  try{
    const salvo=localStorage.getItem('itap_sabores');
    if(salvo){const lista=JSON.parse(salvo);return lista.filter(s=>!s.esgotado).map(s=>s.nome);}
  }catch(e){}
  return produtos&&produtos.sorvetes&&produtos.sorvetes.sabores?produtos.sorvetes.sabores:[];
}
function abrirSabores(tipo,titulo){
  document.getElementById('ms-titulo').textContent=titulo;
  const chips=document.getElementById('ms-chips');chips.innerHTML='';
  const sabores=getSaboresDisponiveis();
  sabores.forEach(s=>{const sp=document.createElement('span');sp.className='chip-sabor';sp.textContent=s;chips.appendChild(sp);});
  abrirModal('modal-sabores');
}

// â”€â”€ MILKSHAKE: TAMANHOS E PREÃ‡OS â”€â”€
function abrirMilkshakeSabores(){
  document.getElementById('ms-titulo').textContent='ğŸ¥¤ Milkshakes â€“ Tamanhos e PreÃ§os';
  const chips=document.getElementById('ms-chips');chips.innerHTML='';
  const m=produtos&&produtos.milkshake?produtos.milkshake:{};
  const opcoes=[];
  if(m.tradicional) Object.entries(m.tradicional).forEach(([tam,p])=>opcoes.push(`Tradicional ${tam} â€“ R$ ${p.toFixed(2).replace('.',',')}`))
  if(m.top) Object.entries(m.top).forEach(([tam,p])=>opcoes.push(`Top ${tam} â€“ R$ ${p.toFixed(2).replace('.',',')}`))
  if(m.adicional_ovomaltine) opcoes.push(`+ Ovomaltine â€“ R$ ${m.adicional_ovomaltine.toFixed(2).replace('.',',')}`);
  opcoes.forEach(s=>{const sp=document.createElement('span');sp.className='chip-sabor';sp.textContent=s;chips.appendChild(sp);});
  document.getElementById('ms-sub').textContent='Escolha o tamanho ao fazer seu pedido na loja';
  abrirModal('modal-sabores');
}
// â”€â”€ TAÃ‡AS TRADICIONAIS â”€â”€
function abrirTacasTradicionais(){
  document.getElementById('ms-titulo').textContent='ğŸ¨ TaÃ§as â€“ 8 OpÃ§Ãµes';
  const chips=document.getElementById('ms-chips');chips.innerHTML='';
  const t=produtos&&produtos.tacas&&produtos.tacas.tradicionais?produtos.tacas.tradicionais:{};
  Object.entries(t).forEach(([nome,p])=>{
    const sp=document.createElement('span');sp.className='chip-sabor';
    sp.textContent=`${nome} â€“ R$ ${p.toFixed(2).replace('.',',')}`;chips.appendChild(sp);
  });
  document.getElementById('ms-sub').textContent='Informe a taÃ§a desejada ao fazer seu pedido na loja';
  abrirModal('modal-sabores');
}
// â”€â”€ TAÃ‡AS PREMIUM (SUJAS) â”€â”€
function abrirTacasSujas(){
  document.getElementById('ms-titulo').textContent='ğŸ† TaÃ§as Premium (Sujas) â€“ 7 OpÃ§Ãµes';
  const chips=document.getElementById('ms-chips');chips.innerHTML='';
  const t=produtos&&produtos.tacas&&produtos.tacas.sujas?produtos.tacas.sujas:{};
  Object.entries(t).forEach(([nome,p])=>{
    const sp=document.createElement('span');sp.className='chip-sabor';
    sp.textContent=`${nome} â€“ R$ ${p.toFixed(2).replace('.',',')}`;chips.appendChild(sp);
  });
  document.getElementById('ms-sub').textContent='Informe a taÃ§a desejada ao fazer seu pedido na loja';
  abrirModal('modal-sabores');
}
// â”€â”€ ABRIR MODAL PICOLÃ‰ â”€â”€
function abrirPicole(key,nome){
  document.getElementById('mp-titulo').textContent=`ğŸ­ Sabores â€“ ${nome}`;
  document.getElementById('mp-sub').textContent='Sabores disponÃ­veis para este tipo de picolÃ©';
  const chips=document.getElementById('mp-chips');chips.innerHTML='';
  const sabs=produtos&&produtos.picoles&&produtos.picoles[key]?produtos.picoles[key].sabores:[];
  sabs.forEach(s=>{const sp=document.createElement('span');sp.className='chip-sabor';sp.textContent=s;chips.appendChild(sp);});
  abrirModal('modal-picole');
}

// â”€â”€ ABRIR COMPLEMENTOS AÃ‡AÃ â”€â”€ (lÃª do products.js)
const labelComp={frutas:'ğŸ“ Frutas',cremes:'ğŸ¯ Cremes',guloseimas:'ğŸ¬ Guloseimas',chocolates:'ğŸ« Chocolates'};
function abrirComplementos(){
  const lista=document.getElementById('comp-lista');lista.innerHTML='';
  if(produtos&&produtos.acai&&produtos.acai.complementos){
    Object.entries(produtos.acai.complementos).forEach(([k,info])=>{
      const g=document.createElement('div');g.className='comp-group';
      g.innerHTML=`<div class="comp-group-h">${labelComp[k]||k}<span class="comp-preco">+ R$ ${info.preco.toFixed(2).replace('.',',')} cada</span></div><div class="chips">${info.itens.map(i=>`<span class="chip-comp">${i}</span>`).join('')}</div>`;
      lista.appendChild(g);
    });
  }
  abrirModal('modal-comp');
}

// â”€â”€ PROMOÃ‡ÃƒO â”€â”€
let promoInt=null;
// â”€â”€ BARRA DE PROMOÃ‡ÃƒO NO TOPO â”€â”€
function carregarBarraPromo(){
  const d=JSON.parse(localStorage.getItem('itap_promo')||'{}');
  const fechada=sessionStorage.getItem('promo_bar_fechada');
  if(!d.ativa&&d.ativa!==undefined){return;} // promoÃ§Ã£o desativada
  if(fechada){return;} // usuÃ¡rio fechou nesta sessÃ£o
  const bar=document.getElementById('promo-top-bar');
  if(!bar)return;
  if(d.titulo){document.getElementById('ptb-titulo').textContent=d.titulo;}
  if(d.descricao){document.getElementById('ptb-sub').textContent=d.descricao;}
  bar.classList.add('show');
}
function fecharBarraPromo(){
  sessionStorage.setItem('promo_bar_fechada','1');
  const bar=document.getElementById('promo-top-bar');
  if(bar){bar.classList.remove('show');}
}

// â”€â”€ PROMOÃ‡ÃƒO DINÃ‚MICA â”€â”€
function carregarPromo(){
  const d=JSON.parse(localStorage.getItem('itap_promo')||'{}');
  if(d.titulo){document.getElementById('promo-title').textContent=d.titulo;}
  if(d.descricao){document.getElementById('promo-desc').textContent=d.descricao;}
  if(d.imagem){
    const img=document.getElementById('promo-img');
    img.src=d.imagem;img.style.display='block';
    document.getElementById('promo-icon').style.display='none';
  }
  if(d.link){
    const btn=document.getElementById('promo-btn');
    btn.textContent=d.btnTexto||'ğŸ”— Ver PromoÃ§Ã£o';
  }
}
function abrirLinkPromo(){
  const d=JSON.parse(localStorage.getItem('itap_promo')||'{}');
  const url=d.link||'https://wa.me/5516991472045';
  window.open(url,'_blank');
}
function abrirPromo(){carregarPromo();abrirModal('promo-overlay');iniciarTimer();}
function iniciarTimer(){
  // Usa data/hora salva pelo admin, ou hoje Ã s 22h como padrÃ£o
  let fim;
  try{
    const d=JSON.parse(localStorage.getItem('itap_promo')||'{}');
    if(d.dataFim&&d.horaFim){
      fim=new Date(d.dataFim+'T'+d.horaFim+':00');
    }
  }catch(e){}
  if(!fim||isNaN(fim)){
    // PadrÃ£o: 1 de abril de 2026 Ã s 22h
    fim=new Date('2026-04-01T22:00:00');
  }
  // Se jÃ¡ passou, nÃ£o exibe
  if(fim<=new Date()){
    document.getElementById('promo-timer').textContent='00:00:00:00';
    return;
  }
  if(promoInt)clearInterval(promoInt);
  promoInt=setInterval(()=>{
    const diff=fim-new Date();
    if(diff<=0){clearInterval(promoInt);document.getElementById('promo-timer').textContent='00:00:00:00';return;}
    const dias=String(Math.floor(diff/86400000)).padStart(2,'0');
    const h=String(Math.floor((diff%86400000)/3600000)).padStart(2,'0');
    const m=String(Math.floor((diff%3600000)/60000)).padStart(2,'0');
    const s=String(Math.floor((diff%60000)/1000)).padStart(2,'0');
    document.getElementById('promo-timer').textContent=`${dias}:${h}:${m}:${s}`;
  },1000);
}

// â”€â”€ CHATBOT â”€â”€
const RESPOSTAS={
  'horÃ¡rio':'Funcionamos de Segunda a Domingo, das 10h Ã s 22h. ğŸ•™',
  'funciona':'Funcionamos de Segunda a Domingo, das 10h Ã s 22h. ğŸ•™',
  'aberto':'Funcionamos de Segunda a Domingo, das 10h Ã s 22h. ğŸ•™',
  'endereÃ§o':'Estamos na PÃ§a Lgo SÃ£o Bento, 311 â€“ Centro, Cajuru/SP. ğŸ“',
  'localizaÃ§Ã£o':'Estamos na PÃ§a Lgo SÃ£o Bento, 311 â€“ Centro, Cajuru/SP. ğŸ“',
  'onde':'Estamos na PÃ§a Lgo SÃ£o Bento, 311 â€“ Centro, Cajuru/SP. ğŸ“',
  'encomendar':'Para encomendas, clique em ğŸ›’ Encomendas no topo! Trabalhamos com Sorvete em Caixa, Torta de Sorvete e PicolÃ©s no atacado. Prazo: 3 dias Ãºteis apÃ³s pagamento. ğŸ“¦',
  'encomenda':'Para encomendas, clique em ğŸ›’ Encomendas no topo! Trabalhamos com Sorvete em Caixa, Torta de Sorvete e PicolÃ©s no atacado. Prazo: 3 dias Ãºteis apÃ³s pagamento. ğŸ“¦',
  'sabor':'Temos 36 sabores de sorvete! Chocolate, Nutella, Leite Ninho, Morango Trufado, Ferrero Rocher, Pistache e muito mais. Veja no cardÃ¡pio! ğŸ¦',
  'sabores':'Temos 36 sabores de sorvete! Chocolate, Nutella, Leite Ninho, Morango Trufado, Ferrero Rocher, Pistache e muito mais. Veja no cardÃ¡pio! ğŸ¦',
  'preÃ§o':()=>`Sorvetes a partir de R$ ${Object.values(produtos.sorvetes.precos.casquinha_copo)[0].toFixed(2).replace('.',',')} Â· Milkshakes a partir de R$ ${Object.values(produtos.milkshake.tradicional)[0].toFixed(2).replace('.',',')} Â· AÃ§aÃ­ a partir de R$ ${Object.values(produtos.acai.copos)[0].toFixed(2).replace('.',',')}. ğŸ’°`,
  'preco':()=>`Sorvetes a partir de R$ ${Object.values(produtos.sorvetes.precos.casquinha_copo)[0].toFixed(2).replace('.',',')} Â· Milkshakes a partir de R$ ${Object.values(produtos.milkshake.tradicional)[0].toFixed(2).replace('.',',')} Â· AÃ§aÃ­ a partir de R$ ${Object.values(produtos.acai.copos)[0].toFixed(2).replace('.',',')}. ğŸ’°`,
  'preÃ§os':()=>`Sorvetes a partir de R$ ${Object.values(produtos.sorvetes.precos.casquinha_copo)[0].toFixed(2).replace('.',',')} Â· Milkshakes a partir de R$ ${Object.values(produtos.milkshake.tradicional)[0].toFixed(2).replace('.',',')} Â· AÃ§aÃ­ a partir de R$ ${Object.values(produtos.acai.copos)[0].toFixed(2).replace('.',',')}. ğŸ’°`,
  'aÃ§aÃ­':()=>`AÃ§aÃ­ artesanal em ${Object.entries(produtos.acai.copos).map(([t,p])=>`${t} (R$ ${p.toFixed(0)})`).join(', ')}. Personalize com frutas, cremes e chocolates! ğŸ«`,
  'acai':()=>`AÃ§aÃ­ artesanal em ${Object.entries(produtos.acai.copos).map(([t,p])=>`${t} (R$ ${p.toFixed(0)})`).join(', ')}. Personalize com frutas, cremes e chocolates! ğŸ«`,
  'picolÃ©':()=>`${Object.values(produtos.picoles).map(p=>`${p.nome} (R$ ${p.preco_varejo.toFixed(2).replace('.',',')})`).join(' Â· ')}. Atacado via encomenda! ğŸ­`,
  'picole':()=>`${Object.values(produtos.picoles).map(p=>`${p.nome} (R$ ${p.preco_varejo.toFixed(2).replace('.',',')})`).join(' Â· ')}. Atacado via encomenda! ğŸ­`,
  'picolÃ©s':()=>`${Object.values(produtos.picoles).map(p=>`${p.nome} (R$ ${p.preco_varejo.toFixed(2).replace('.',',')})`).join(' Â· ')}. Atacado via encomenda! ğŸ­`,
  'delivery':'NÃ£o fazemos delivery. Retirada somente na loja: PÃ§a Lgo SÃ£o Bento, 311 â€“ Cajuru/SP. ğŸª',
  'entrega':'Para encomendas, prazo de 3 dias Ãºteis apÃ³s pagamento. Retirada na loja. ğŸ“¦',
  'telefone':'WhatsApp: (16) 99147-2045 ğŸ“±',
  'whatsapp':'WhatsApp: (16) 99147-2045 ğŸ“±',
  'contato':'WhatsApp: (16) 99147-2045 ğŸ“±',
  'torta':()=>`Torta de Sorvete R$ ${produtos.sobremesas['Torta de Sorvete'].toFixed(2).replace('.',',')} com 3 sabores Ã  escolha. Encomende com 3 dias de antecedÃªncia! ğŸ‚`,
  'caixa':()=>`Caixas de 5L (a partir de R$ ${Math.min(...Object.values(produtos.caixas_viagem).filter((_,i,a)=>i<2)).toFixed(0)}) e 10L (a partir de R$ ${Math.min(...Object.values(produtos.caixas_viagem).filter((_,i,a)=>i>=2)).toFixed(0)}) com 2 ou 3 sabores. FaÃ§a sua encomenda! ğŸ¦`,
  'cajuru':'Estamos em Cajuru/SP desde 2007! Atendemos tambÃ©m Santa Cruz da EsperanÃ§a e CÃ¡ssia dos Coqueiros. ğŸ“',
  'default':'Posso te ajudar com: horÃ¡rios, endereÃ§o, preÃ§os, sabores, encomendas ou picolÃ©s. O que deseja saber? ğŸ˜Š'
};

function abrirChat(){abrirModal('chat-overlay');}
function enviarSug(btn){document.getElementById('chat-inp').value=btn.textContent;enviarChat();}
function enviarChat(){
  const inp=document.getElementById('chat-inp');
  const msg=inp.value.trim();if(!msg)return;
  inp.value='';
  addMsg('user',msg);
  const t=document.getElementById('chat-typing');t.classList.add('show');
  setTimeout(()=>{t.classList.remove('show');addMsg('bot',getResp(msg));},700+Math.random()*500);
}
function addMsg(tipo,txt){
  const m=document.getElementById('chat-msgs');
  const d=document.createElement('div');d.className=`msg ${tipo}`;d.textContent=txt;
  m.appendChild(d);m.scrollTop=m.scrollHeight;
}
function getResp(msg){
  const l=msg.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'');
  for(const[k,r]of Object.entries(RESPOSTAS)){
    if(k!=='default'&&l.includes(k)){
      return typeof r==='function'?r():r;
    }
  }
  const d=RESPOSTAS.default;
  return typeof d==='function'?d():d;
}

// â”€â”€ PWA â”€â”€
let deferredPrompt=null;
window.addEventListener('beforeinstallprompt',e=>{
  e.preventDefault();deferredPrompt=e;
  setTimeout(()=>document.getElementById('pwa-banner').classList.add('show'),3000);
});
document.getElementById('pwa-btn').addEventListener('click',async()=>{
  if(deferredPrompt){deferredPrompt.prompt();await deferredPrompt.userChoice;deferredPrompt=null;document.getElementById('pwa-banner').classList.remove('show');}
});

// â”€â”€ COMPLEMENTOS CARDÃPIO â”€â”€
function getComplementosCardapio() {
  const PADRAO = [
    {id:'canudinho',nome:'Canudinho Wafer UN',preco:0.25,estoque:999},
    {id:'casquinha',nome:'Casquinhas UN',preco:0.25,estoque:999},
    {id:'cascao',nome:'CascÃ£o UN',preco:1.00,estoque:999},
    {id:'cestinha',nome:'Cestinha UN',preco:1.00,estoque:999},
    {id:'cobertura',nome:'Cobertura 1.3L UN',preco:40.00,estoque:999}
  ];
  try { const s = localStorage.getItem('itap_complementos'); if(s) return JSON.parse(s); } catch(e){}
  return PADRAO;
}
function renderComplementosCardapio() {
  const el = document.getElementById('acc-body-complementos');
  if (!el) return;
  const comps = getComplementosCardapio();
  let fotos = {};
  try { fotos = JSON.parse(localStorage.getItem('itap_fotos') || '{}'); } catch(e){}
  el.innerHTML = `
    <div style="padding:4px 0 10px">
      <p style="font-size:0.82rem;color:#555;margin:0 0 12px;text-align:center;">Clique em qualquer produto para ir Ã s encomendas e continuar comprando</p>
      ${comps.map(c => {
        const esgotado = c.estoque <= 0;
        const foto = fotos['comp_enc_'+c.id] || '';
        const fotoHtml = foto
          ? `<img src="${foto}" style="width:50px;height:50px;object-fit:cover;border-radius:10px;margin-right:12px;flex-shrink:0;" onerror="this.style.display='none'">`
          : `<div style="width:50px;height:50px;border-radius:10px;background:linear-gradient(135deg,#FFEBEE,#FFCDD2);display:flex;align-items:center;justify-content:center;font-size:24px;margin-right:12px;flex-shrink:0;">ğŸª</div>`;
        return `<a href="encomendas.html#caixas" style="display:flex;align-items:center;background:${esgotado?'#FFF3F3':'#FAFAFA'};border:1.5px solid ${esgotado?'#FFCDD2':'#E0E0E0'};border-radius:12px;padding:12px;margin-bottom:10px;text-decoration:none;${esgotado?'opacity:0.6;pointer-events:none;':''};cursor:pointer;">
          ${fotoHtml}
          <div style="flex:1;">
            <div style="font-size:0.9rem;font-weight:800;color:#1A0A00;">${c.nome}${esgotado?'<span style="font-size:0.7rem;background:#EF5350;color:#fff;border-radius:4px;padding:2px 6px;margin-left:6px;">ESGOTADO</span>':''}</div>
            <div style="font-size:0.82rem;color:#B71C1C;font-weight:700;">R$ ${c.preco.toFixed(2).replace('.',',')} / un.</div>
          </div>
          <span style="font-size:1.2rem;color:#B71C1C;font-weight:900;margin-left:8px;">â€º</span>
        </a>`;
      }).join('')}
      <a href="encomendas.html#caixas" style="display:block;width:100%;padding:14px;background:linear-gradient(135deg,#B71C1C,#E53935);color:#fff;border:none;border-radius:12px;font-size:0.95rem;font-weight:900;cursor:pointer;margin-top:6px;text-align:center;text-decoration:none;">ğŸ›’ Ir para Encomendas e Comprar â†’</a>
    </div>`;
}

// â”€â”€ BANNER CARDÃPIO â”€â”€
// Se houver banner personalizado no admin, sobrepÃµe o padrÃ£o
function carregarBanner(){
  try{
    const dados=JSON.parse(localStorage.getItem('itap_banner')||'{}');
    if(dados.img){
      const img=document.getElementById('cardapio-banner-img');
      if(img) img.src=dados.img;
    }
  }catch(e){}
}
// â”€â”€ INIT â”€â”€
document.addEventListener('DOMContentLoaded',()=>{
  carregarBanner();
  carregarBarraPromo();
  renderSorvetes();renderMilk();renderTacas();renderTacasP();renderAcaiPromo();renderAcai();renderPicoles();renderIso();renderSobremesas();
  renderComplementosCardapio();
  // Todos os accordions fechados por padrÃ£o
  // Foto da torta
  const tortaFotoArea=document.getElementById('torta-foto-area');
  if(tortaFotoArea)tortaFotoArea.innerHTML=imgCard('sobremesa_Torta_de_Sorvete','ğŸ‚');
  // Atualizar preÃ§o da torta do products.js
  const tp=document.getElementById('torta-preco');
  if(tp&&produtos&&produtos.sobremesas)tp.textContent='R$ '+produtos.sobremesas['Torta de Sorvete'].toFixed(2).replace('.',',');
  // Corrigir chatbot: resolver funÃ§Ãµes
  Object.keys(respostas).forEach(k=>{if(typeof respostas[k]==='function')respostas[k]=respostas[k]();});
});
</script>
</body>
</html>
