<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin ‚Äì Itapolitana Cajuru</title>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Inter',sans-serif;background:#f5f5f8;color:#111827;min-height:100vh}
.login-wrap{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
.login-box{background:#fff;border-radius:16px;padding:32px 24px;max-width:360px;width:100%;box-shadow:0 4px 24px rgba(0,0,0,.1);text-align:center}
.login-box h2{font-size:20px;font-weight:900;margin-bottom:8px}
.login-box p{font-size:13px;color:#6A0DAD;font-weight:700;margin-bottom:24px}
.login-box input{width:100%;padding:12px 14px;border:1px solid #E5E7EB;border-radius:10px;font-size:15px;margin-bottom:12px;outline:none}
.login-box input:focus{border-color:#6A0DAD}
.btn-login{width:100%;padding:13px;background:#6A0DAD;color:#fff;border:none;border-radius:10px;font-size:15px;font-weight:800;cursor:pointer}
.btn-login:hover{background:#5a0b9d}
.back-link{display:block;margin-top:16px;font-size:13px;color:#6A0DAD;text-decoration:none}
#admin-panel{display:none}
.admin-header{background:#1F2937;color:#fff;padding:14px 20px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100}
.admin-header h1{font-size:16px;font-weight:800}
.btn-logout{background:#EF4444;color:#fff;border:none;border-radius:8px;padding:8px 16px;font-size:13px;font-weight:700;cursor:pointer}
.admin-body{max-width:960px;margin:0 auto;padding:20px 16px 100px}
.cat-section{background:#fff;border-radius:14px;border:1px solid #E5E7EB;margin-bottom:16px;overflow:hidden}
.cat-header{padding:14px 18px;background:#F9FAFB;border-bottom:1px solid #E5E7EB;display:flex;align-items:center;gap:10px;cursor:pointer;user-select:none}
.cat-header h3{font-size:15px;font-weight:800;flex:1}
.cat-arrow{font-size:12px;color:#6A0DAD;transition:transform .3s}
.cat-section.open .cat-arrow{transform:rotate(180deg)}
.cat-body{display:none;padding:16px}
.cat-section.open .cat-body{display:block}
.prod-edit-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
.prod-edit-card{background:#F9FAFB;border:1px solid #E5E7EB;border-radius:10px;padding:14px}
.prod-edit-card h4{font-size:13px;font-weight:800;margin-bottom:10px;color:#111827}
.field-row{display:flex;gap:8px;margin-bottom:8px}
.field-row label{font-size:11px;font-weight:700;color:#6A0DAD;display:block;margin-bottom:3px}
.field-row input{width:100%;padding:7px 10px;border:1px solid #E5E7EB;border-radius:7px;font-size:13px;outline:none}
.field-row input:focus{border-color:#6A0DAD}
.btn-esgotar{width:100%;padding:7px;background:#FEE2E2;color:#EF4444;border:1px solid #FECACA;border-radius:7px;font-size:12px;font-weight:700;cursor:pointer;margin-top:4px}
.btn-esgotar.esgotado{background:#EF4444;color:#fff}
.sabores-grid{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
.sabor-chip{background:#E3F2FD;color:#1565C0;border:1px solid #90CAF9;border-radius:20px;padding:5px 12px;font-size:12px;font-weight:600;cursor:pointer;user-select:none}
.sabor-chip.esgotado{background:#FEE2E2;color:#EF4444;border-color:#FECACA;text-decoration:line-through}
.preco-simples-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:10px}
.preco-simples-card{background:#F9FAFB;border:1px solid #E5E7EB;border-radius:10px;padding:12px}
.preco-simples-card label{font-size:12px;font-weight:700;color:#374151;display:block;margin-bottom:6px}
.preco-simples-card input{width:100%;padding:8px 10px;border:1px solid #E5E7EB;border-radius:7px;font-size:14px;font-weight:700;outline:none}
.preco-simples-card input:focus{border-color:#6A0DAD}
.save-bar{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid #E5E7EB;padding:12px 20px;display:flex;gap:10px;justify-content:center;z-index:200}
.btn-save{background:#6A0DAD;color:#fff;border:none;border-radius:10px;padding:12px 32px;font-size:15px;font-weight:800;cursor:pointer}
.btn-save:hover{background:#5a0b9d}
.status-msg{font-size:13px;font-weight:700;color:#10B981;align-self:center}

/* ‚îÄ‚îÄ CAMPO DE FOTO ‚îÄ‚îÄ */
.foto-bloco{margin-bottom:10px}
.foto-bloco-label{font-size:11px;font-weight:700;color:#6A0DAD;margin-bottom:6px;display:flex;align-items:center;gap:4px}
.foto-area{border:2px dashed #D1D5DB;border-radius:10px;overflow:hidden;background:#fff;cursor:pointer;transition:border-color .2s;position:relative;min-height:100px;display:flex;align-items:center;justify-content:center}
.foto-area:hover{border-color:#6A0DAD}
.foto-area.tem-foto{border:2px solid #10B981}
.foto-area img{width:100%;height:120px;object-fit:cover;display:block}
.foto-placeholder{text-align:center;padding:16px 10px;pointer-events:none}
.foto-placeholder .icone{font-size:28px;margin-bottom:4px}
.foto-placeholder p{font-size:11px;color:#9CA3AF;font-weight:600;line-height:1.4}
.foto-placeholder p span{color:#6A0DAD;font-weight:700}
.foto-input{display:none}
.foto-acoes{display:flex;gap:6px;margin-top:6px}
.btn-trocar-foto{flex:1;padding:6px;background:#EDE9FE;color:#6A0DAD;border:1px solid #C4B5FD;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer}
.btn-remover-foto{flex:1;padding:6px;background:#FEE2E2;color:#EF4444;border:1px solid #FECACA;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer}
</style>
</head>
<body>
<div class="login-wrap" id="login-section">
  <div class="login-box">
    <h2>‚öôÔ∏è Painel Admin</h2>
    <p>Sorveteria Itapolitana Cajuru</p>
    <div style="position:relative;width:100%;margin-bottom:12px">
      <input type="password" id="admin-password" placeholder="Senha administrativa" onkeypress="if(event.key==='Enter')checkLogin()" style="width:100%;padding:12px 44px 12px 14px;border:1px solid #E5E7EB;border-radius:10px;font-size:15px;outline:none;box-sizing:border-box">
      <button type="button" id="btn-olho" onclick="toggleSenha()" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;font-size:20px;color:#6A0DAD;padding:0;line-height:1" title="Mostrar/ocultar senha">üëÅÔ∏è</button>
    </div>
    <button class="btn-login" onclick="checkLogin()">Entrar</button>
    <a href="../index.html" class="back-link">‚Üê Voltar ao site</a>
  </div>
</div>
<div id="admin-panel">
  <div class="admin-header">
    <h1>‚öôÔ∏è Gerenciamento ‚Äì Itapolitana Cajuru</h1>
    <button class="btn-logout" onclick="logout()">Sair</button>
  </div>
  <div class="admin-body" id="admin-body"></div>
  <div class="save-bar">
    <span class="status-msg" id="status-msg"></span>
    <button class="btn-save" onclick="salvarTudo()">üíæ Baixar products.js Atualizado</button>
  </div>
</div>
<script src="../scripts/products.js"></script>
<script>
const ADMIN_PASS = "itapolitana2007@";
function toggleSenha() {
  const inp = document.getElementById('admin-password');
  const btn = document.getElementById('btn-olho');
  if (inp.type === 'password') {
    inp.type = 'text';
    btn.textContent = 'üôà';
  } else {
    inp.type = 'password';
    btn.textContent = 'üëÅÔ∏è';
  }
}

// ‚îÄ‚îÄ FOTOS: salvas em localStorage por chave √∫nica ‚îÄ‚îÄ
function getFotos() {
  try { return JSON.parse(localStorage.getItem('itap_fotos') || '{}'); } catch(e){ return {}; }
}
function salvarFoto(chave, base64) {
  const fotos = getFotos();
  fotos[chave] = base64;
  localStorage.setItem('itap_fotos', JSON.stringify(fotos));
}
function removerFoto(chave) {
  const fotos = getFotos();
  delete fotos[chave];
  localStorage.setItem('itap_fotos', JSON.stringify(fotos));
}

// ‚îÄ‚îÄ BLOCO HTML DE FOTO ‚îÄ‚îÄ
function blocoFoto(chave) {
  const fotos = getFotos();
  const temFoto = !!fotos[chave];
  const imgSrc = temFoto ? fotos[chave] : '';
  return `
    <div class="foto-bloco" id="foto-bloco-${chave}">
      <div class="foto-bloco-label">üì∑ Foto do Produto</div>
      <div class="foto-area ${temFoto ? 'tem-foto' : ''}" onclick="document.getElementById('foto-input-${chave}').click()">
        ${temFoto
          ? `<img src="${imgSrc}" alt="Foto" id="foto-img-${chave}">`
          : `<div class="foto-placeholder" id="foto-placeholder-${chave}"><div class="icone">üì∑</div><p>Toque para<br><span>adicionar foto</span></p></div>`
        }
      </div>
      <input type="file" accept="image/*" class="foto-input" id="foto-input-${chave}"
        onchange="onFotoChange('${chave}', this)">
      ${temFoto ? `
      <div class="foto-acoes" id="foto-acoes-${chave}">
        <button class="btn-trocar-foto" onclick="document.getElementById('foto-input-${chave}').click()">üîÑ Trocar</button>
        <button class="btn-remover-foto" onclick="onRemoverFoto('${chave}')">üóëÔ∏è Remover</button>
      </div>` : `<div class="foto-acoes" id="foto-acoes-${chave}" style="display:none">
        <button class="btn-trocar-foto" onclick="document.getElementById('foto-input-${chave}').click()">üîÑ Trocar</button>
        <button class="btn-remover-foto" onclick="onRemoverFoto('${chave}')">üóëÔ∏è Remover</button>
      </div>`}
    </div>`;
}

function onFotoChange(chave, input) {
  const file = input.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    const base64 = e.target.result;
    salvarFoto(chave, base64);
    // Atualizar UI
    const area = input.closest('.foto-area') || input.parentElement.querySelector('.foto-area');
    const blocoEl = document.getElementById('foto-bloco-' + chave);
    const fotoArea = blocoEl.querySelector('.foto-area');
    fotoArea.classList.add('tem-foto');
    fotoArea.innerHTML = `<img src="${base64}" alt="Foto" id="foto-img-${chave}">`;
    const acoes = document.getElementById('foto-acoes-' + chave);
    acoes.style.display = 'flex';
    // Reatribuir onclick ao trocar
    fotoArea.onclick = () => document.getElementById('foto-input-' + chave).click();
  };
  reader.readAsDataURL(file);
}

function onRemoverFoto(chave) {
  removerFoto(chave);
  const blocoEl = document.getElementById('foto-bloco-' + chave);
  const fotoArea = blocoEl.querySelector('.foto-area');
  fotoArea.classList.remove('tem-foto');
  fotoArea.innerHTML = `<div class="foto-placeholder" id="foto-placeholder-${chave}"><div class="icone">üì∑</div><p>Toque para<br><span>adicionar foto</span></p></div>`;
  fotoArea.onclick = () => document.getElementById('foto-input-' + chave).click();
  const acoes = document.getElementById('foto-acoes-' + chave);
  acoes.style.display = 'none';
}

// ‚îÄ‚îÄ BANNER DO CARD√ÅPIO ‚îÄ‚îÄ
function onBannerChange(input) {
  const file = input.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(e) {
    localStorage.setItem('itap_banner', JSON.stringify({ img: e.target.result }));
    const preview = document.getElementById('banner-preview-area');
    if (preview) preview.innerHTML = `<img src="${e.target.result}" style="width:100%;max-height:180px;object-fit:cover;border-radius:10px;display:block">`;
    const status = document.getElementById('banner-status');
    if (status) { status.textContent = '‚úÖ Banner salvo! J√° vis√≠vel no card√°pio.'; setTimeout(() => status.textContent = '', 4000); }
    setTimeout(() => renderAdmin(), 200);
  };
  reader.readAsDataURL(file);
}
function removerBanner() {
  localStorage.removeItem('itap_banner');
  renderAdmin();
}

// ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ
function checkLogin() {
  const p = document.getElementById('admin-password').value;
  if (p === ADMIN_PASS) {
    document.getElementById('login-section').style.display = 'none';
    document.getElementById('admin-panel').style.display = 'block';
    renderAdmin();
  } else { alert('Senha incorreta!'); }
}
function logout() { location.reload(); }
function toggleCat(id) { document.getElementById('cat-' + id).classList.toggle('open'); }
function criarSecao(id, titulo, conteudo) {
  const s = document.createElement('div');
  s.className = 'cat-section'; s.id = 'cat-' + id;
  s.innerHTML = `<div class="cat-header" onclick="toggleCat('${id}')"><h3>${titulo}</h3><span class="cat-arrow">‚ñº</span></div><div class="cat-body">${conteudo}</div>`;
  return s;
}

// ‚îÄ‚îÄ RENDER ADMIN ‚îÄ‚îÄ
function renderAdmin() {
  const body = document.getElementById('admin-body'); body.innerHTML = '';
  const promoCard = document.createElement('div');
  promoCard.style.cssText = 'background:linear-gradient(135deg,#1565C0,#D32F2F);border-radius:14px;padding:18px 20px;margin-bottom:16px;display:flex;align-items:center;justify-content:space-between;color:#fff;flex-wrap:wrap;gap:12px';
  promoCard.innerHTML = '<div><div style="font-size:15px;font-weight:800">üéâ Gerenciar Promo√ß√£o</div><div style="font-size:12px;opacity:.85;margin-top:3px">Poste foto, texto e link da promo√ß√£o do dia</div></div><a href="promocao.html" style="background:#F9A825;color:#111;border-radius:10px;padding:10px 18px;font-size:13px;font-weight:800;text-decoration:none;white-space:nowrap">Abrir ‚Üí</a>';
  body.appendChild(promoCard);

  // ‚îÄ‚îÄ CARD ESTOQUE DE INSUMOS ‚îÄ‚îÄ
  const estoqueCard = document.createElement('div');
  estoqueCard.style.cssText = 'background:linear-gradient(135deg,#1F2937,#374151);border-radius:14px;padding:18px 20px;margin-bottom:16px;display:flex;align-items:center;justify-content:space-between;color:#fff;flex-wrap:wrap;gap:12px';
  estoqueCard.innerHTML = '<div><div style="font-size:15px;font-weight:800">üì¶ Estoque de Insumos</div><div style="font-size:12px;opacity:.85;margin-top:3px">Controle ingredientes, embalagens e materiais (at√© 300 itens)</div></div><a href="estoque.html" style="background:#10B981;color:#fff;border-radius:10px;padding:10px 18px;font-size:13px;font-weight:800;text-decoration:none;white-space:nowrap">üì¶ Abrir Estoque ‚Üí</a>';
  body.appendChild(estoqueCard);

  // ‚îÄ‚îÄ CARD BANNER DO SITE ‚îÄ‚îÄ
  const bannerCard = document.createElement('div');
  bannerCard.style.cssText = 'background:#fff;border-radius:14px;border:2px solid #6A0DAD;padding:18px 20px;margin-bottom:16px';
  const bannerDados = (()=>{try{return JSON.parse(localStorage.getItem('itap_banner')||'{}');}catch(e){return {};}})();
  const temBanner = !!bannerDados.img;
  // Banner atual: se tiver no localStorage usa ele, sen√£o mostra o padr√£o do site
  const bannerSrc = temBanner ? bannerDados.img : '../images/banner-cardapio.png';
  bannerCard.innerHTML = `
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:14px">
      <span style="font-size:24px">üñºÔ∏è</span>
      <div>
        <div style="font-size:16px;font-weight:900;color:#6A0DAD">Banner do Site</div>
        <div style="font-size:12px;color:#6B7280;margin-top:2px">Aparece no topo do card√°pio. Substitua quando quiser.</div>
      </div>
    </div>
    <div id="banner-preview-area" style="margin-bottom:14px;border-radius:12px;overflow:hidden;box-shadow:0 2px 12px rgba(0,0,0,.12)">
      <img src="${bannerSrc}" style="width:100%;max-height:200px;object-fit:cover;display:block" onerror="this.style.display='none'">
    </div>
    <label style="display:flex;align-items:center;justify-content:center;gap:8px;width:100%;background:linear-gradient(135deg,#6A0DAD,#9C27B0);color:#fff;border-radius:10px;padding:14px;font-size:15px;font-weight:800;cursor:pointer;box-shadow:0 4px 14px rgba(106,13,173,.4);margin-bottom:8px">
      üì∑ Substituir Banner do Site
      <input type="file" accept="image/*" style="display:none" onchange="onBannerChange(this)">
    </label>
    ${temBanner ? `<button onclick="removerBanner()" style="width:100%;background:#FEE2E2;color:#EF4444;border:1px solid #FECACA;border-radius:10px;padding:10px;font-size:13px;font-weight:700;cursor:pointer">üîÑ Restaurar Banner Padr√£o</button>` : ''}
    <div id="banner-status" style="margin-top:10px;font-size:13px;font-weight:700;color:#10B981;text-align:center"></div>
  `;
  body.appendChild(bannerCard);

  // ‚îÄ‚îÄ CARD SABORES DE SORVETE ‚îÄ‚îÄ
  const saboresCard = document.createElement('div');
  saboresCard.style.cssText = 'background:#fff;border-radius:14px;border:2px solid #E8000D;padding:18px 20px;margin-bottom:16px';
  saboresCard.innerHTML = `
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:14px">
      <span style="font-size:24px">üç¶</span>
      <div>
        <div style="font-size:16px;font-weight:900;color:#E8000D">Sabores de Sorvete</div>
        <div style="font-size:12px;color:#6B7280;margin-top:2px">Gerencie os sabores dispon√≠veis no card√°pio e encomendas</div>
      </div>
    </div>
    <div style="display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap">
      <input id="novo-sabor-input" type="text" placeholder="Nome do novo sabor..." style="flex:1;min-width:180px;padding:10px 14px;border:2px solid #E5E7EB;border-radius:10px;font-size:14px;outline:none" onfocus="this.style.borderColor='#E8000D'" onblur="this.style.borderColor='#E5E7EB'">
      <button onclick="adicionarSabor()" style="background:linear-gradient(135deg,#E8000D,#FF6B35);color:#fff;border:none;border-radius:10px;padding:10px 18px;font-size:14px;font-weight:800;cursor:pointer;white-space:nowrap">‚ûï Acrescentar</button>
    </div>
    <div id="lista-sabores-admin" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:8px"></div>
    <div id="sabores-status" style="margin-top:10px;font-size:13px;font-weight:700;color:#10B981;text-align:center"></div>
  `;
  body.appendChild(saboresCard);
  renderSaboresAdmin();

  body.appendChild(criarSecao('sorvetes', 'üç¶ Sorvetes de Massa', renderSorvetes()));
  body.appendChild(criarSecao('picoles', 'üç≠ Picol√©s', renderPicoles()));
  body.appendChild(criarSecao('acai', 'ü´ê A√ßa√≠ Artesanal', renderAcai()));
  body.appendChild(criarSecao('milkshake', 'ü•§ Milkshakes', renderMilkshake()));
  body.appendChild(criarSecao('tacas', 'üç® Ta√ßas', renderTacas()));
  body.appendChild(criarSecao('caixas', 'üì¶ Caixas de Viagem', renderCaixas()));
  body.appendChild(criarSecao('isopores', 'üßä Isopores de Viagem', renderIsopores()));
  body.appendChild(criarSecao('sobremesas', 'üéÇ Sobremesas', renderSobremesas()));
}

// ‚îÄ‚îÄ SORVETES ‚îÄ‚îÄ
function renderSorvetes() {
  const p = produtos.sorvetes;
  const nomes = { casquinha_copo: 'Casquinha/Copo', copo_recheado: 'Copo Recheado', cascao: 'Casc√£o', cestinha: 'Cestinha' };
  let html = '<h4 style="margin-bottom:10px;font-size:13px;color:#6A0DAD">Pre√ßos por Apresenta√ß√£o</h4><div class="preco-simples-grid">';
  Object.entries(p.precos).forEach(([key, precos]) => {
    Object.entries(precos).forEach(([tam, preco]) => {
      const chave = 'sorvete_' + key + '_' + tam.replace(/\s/g,'_');
      html += `<div class="preco-simples-card">
        ${blocoFoto(chave)}
        <label>${nomes[key] || key} ‚Äì ${tam}</label>
        <input type="number" step="0.01" value="${preco}" onchange="produtos.sorvetes.precos['${key}']['${tam}']=parseFloat(this.value)">
      </div>`;
    });
  });
  html += '</div><h4 style="margin:16px 0 10px;font-size:13px;color:#6A0DAD">Sabores (clique para marcar esgotado)</h4><div class="sabores-grid">';
  p.sabores.forEach(s => { html += `<span class="sabor-chip" onclick="this.classList.toggle('esgotado')">${s}</span>`; });
  html += '</div>';
  return html;
}

// ‚îÄ‚îÄ PICOL√âS ‚îÄ‚îÄ
function renderPicoles() {
  let html = '<div class="prod-edit-grid">';
  Object.entries(produtos.picoles).forEach(([key, p]) => {
    const chave = 'picole_' + key;
    html += `<div class="prod-edit-card">
      ${blocoFoto(chave)}
      <h4>${p.nome}</h4>
      <div class="field-row">
        <div style="flex:1"><label>Varejo (R$)</label><input type="number" step="0.01" value="${p.preco_varejo}" onchange="produtos.picoles['${key}'].preco_varejo=parseFloat(this.value)"></div>
        <div style="flex:1"><label>Atacado (R$)</label><input type="number" step="0.01" value="${p.preco_atacado}" onchange="produtos.picoles['${key}'].preco_atacado=parseFloat(this.value)"></div>
      </div>
      <div class="field-row"><div style="flex:1"><label>Estoque</label><input type="number" min="0" max="200" value="${p.estoque}" onchange="produtos.picoles['${key}'].estoque=parseInt(this.value)"></div></div>
      <div style="margin-top:8px;font-size:11px;color:#6A0DAD;font-weight:700">Sabores:</div>
      <div class="sabores-grid" style="margin-top:6px">${p.sabores.map(s => `<span class="sabor-chip" onclick="this.classList.toggle('esgotado')">${s}</span>`).join('')}</div>
      <button class="btn-esgotar" onclick="produtos.picoles['${key}'].estoque=0;this.closest('.prod-edit-card').querySelector('input[min]').value=0;this.classList.add('esgotado');this.textContent='‚ö†Ô∏è Esgotado'">Marcar Esgotado</button>
    </div>`;
  });
  html += '</div>';
  return html;
}

// ‚îÄ‚îÄ A√áA√ç ‚îÄ‚îÄ
function renderAcai() {
  let html = '<h4 style="margin-bottom:10px;font-size:13px;color:#6A0DAD">Tamanhos de Copo</h4><div class="preco-simples-grid">';
  Object.entries(produtos.acai.copos).forEach(([tam, preco]) => {
    const chave = 'acai_' + tam.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>A√ßa√≠ ${tam}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.acai.copos['${tam}']=parseFloat(this.value)">
    </div>`;
  });
  html += '</div><h4 style="margin:16px 0 10px;font-size:13px;color:#6A0DAD">Complementos</h4>';
  const lbl = { frutas: 'üçì Frutas', cremes: 'üçØ Cremes', guloseimas: 'üç¨ Guloseimas', chocolates: 'üç´ Chocolates' };
  Object.entries(produtos.acai.complementos).forEach(([k, info]) => {
    html += `<div style="margin-bottom:12px"><div style="display:flex;align-items:center;gap:10px;margin-bottom:6px"><span style="font-size:13px;font-weight:700">${lbl[k] || k}</span><span style="font-size:11px;color:#6A0DAD">Pre√ßo: R$</span><input type="number" step="0.01" value="${info.preco}" style="width:70px;padding:4px 8px;border:1px solid #E5E7EB;border-radius:6px;font-size:13px" onchange="produtos.acai.complementos['${k}'].preco=parseFloat(this.value)"></div><div class="sabores-grid">${info.itens.map(i => `<span class="sabor-chip" onclick="this.classList.toggle('esgotado')">${i}</span>`).join('')}</div></div>`;
  });
  return html;
}

// ‚îÄ‚îÄ MILKSHAKE ‚îÄ‚îÄ
function renderMilkshake() {
  const m = produtos.milkshake;
  let html = '<div class="preco-simples-grid">';
  Object.entries(m.tradicional).forEach(([tam, preco]) => {
    const chave = 'milk_trad_' + tam.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>Tradicional ${tam}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.milkshake.tradicional['${tam}']=parseFloat(this.value)">
    </div>`;
  });
  Object.entries(m.top).forEach(([tam, preco]) => {
    const chave = 'milk_top_' + tam.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>Top ${tam}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.milkshake.top['${tam}']=parseFloat(this.value)">
    </div>`;
  });
  html += `<div class="preco-simples-card">
    ${blocoFoto('milk_ovomaltine')}
    <label>Adicional Ovomaltine</label>
    <input type="number" step="0.01" value="${m.adicional_ovomaltine}" onchange="produtos.milkshake.adicional_ovomaltine=parseFloat(this.value)">
  </div>`;
  html += '</div>';
  return html;
}

// ‚îÄ‚îÄ TA√áAS ‚îÄ‚îÄ
function renderTacas() {
  let html = '<h4 style="margin-bottom:10px;font-size:13px;color:#6A0DAD">Ta√ßas Tradicionais</h4><div class="preco-simples-grid">';
  Object.entries(produtos.tacas.tradicionais).forEach(([nome, preco]) => {
    const chave = 'taca_trad_' + nome.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>Ta√ßa ${nome}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.tacas.tradicionais['${nome}']=parseFloat(this.value)">
    </div>`;
  });
  html += '</div><h4 style="margin:16px 0 10px;font-size:13px;color:#6A0DAD">Ta√ßas Sujas</h4><div class="preco-simples-grid">';
  Object.entries(produtos.tacas.sujas).forEach(([nome, preco]) => {
    const chave = 'taca_suja_' + nome.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>Ta√ßa Suja ‚Äì ${nome}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.tacas.sujas['${nome}']=parseFloat(this.value)">
    </div>`;
  });
  html += '</div>';
  return html;
}

// ‚îÄ‚îÄ CAIXAS ‚îÄ‚îÄ
function renderCaixas() {
  let html = '<div class="preco-simples-grid">';
  Object.entries(produtos.caixas_viagem).forEach(([nome, preco]) => {
    const chave = 'caixa_' + nome.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>${nome}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.caixas_viagem['${nome}']=parseFloat(this.value)">
    </div>`;
  });
  html += '</div>';
  return html;
}

// ‚îÄ‚îÄ ISOPORES ‚îÄ‚îÄ
function renderIsopores() {
  let html = '<div class="preco-simples-grid">';
  Object.entries(produtos.isopores_viagem).forEach(([nome, preco]) => {
    const chave = 'isopore_' + nome.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>${nome}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.isopores_viagem['${nome}']=parseFloat(this.value)">
    </div>`;
  });
  html += '</div>';
  return html;
}

// ‚îÄ‚îÄ SOBREMESAS ‚îÄ‚îÄ
function renderSobremesas() {
  let html = '<div class="preco-simples-grid">';
  Object.entries(produtos.sobremesas).forEach(([nome, preco]) => {
    const chave = 'sobremesa_' + nome.replace(/\s/g,'_');
    html += `<div class="preco-simples-card">
      ${blocoFoto(chave)}
      <label>${nome}</label>
      <input type="number" step="0.01" value="${preco}" onchange="produtos.sobremesas['${nome}']=parseFloat(this.value)">
    </div>`;
  });
  html += '</div>';
  return html;
}

// ‚îÄ‚îÄ SABORES DE SORVETE ‚îÄ‚îÄ
const SABORES_PADRAO = [
  "Abacaxi ao Vinho","Abacaxi Su√≠√ßo","Algod√£o Doce (Blue Ice)","Amarena","Ameixa",
  "Banana com Nutella","Bis e Trufa","Cereja Trufada","Chocolate","Chocolate com Caf√©",
  "Coco Queimado","Creme Paris","Croquer","Doce de Leite","Ferrero Rocher",
  "Flocos","Kinder Ovo","Leite Condensado","Leite Ninho",
  "Leite Ninho Foleado","Leite Ninho com √ìreo","Lim√£o",
  "Lim√£o Su√≠√ßo","Menta com Chocolate","Milho Verde","Morango Trufado",
  "Mousse de Maracuj√°","Mousse de Uva","Nozes","Nutella","Ovomaltine",
  "Pistache","Prest√≠gio","Sensa√ß√£o","Torta de Chocolate"
];

function getSaboresAdmin() {
  try {
    const salvo = localStorage.getItem('itap_sabores');
    if (salvo) return JSON.parse(salvo);
  } catch(e) {}
  // Inicializar com sabores padr√£o
  const lista = SABORES_PADRAO.map(nome => ({ nome, esgotado: false }));
  localStorage.setItem('itap_sabores', JSON.stringify(lista));
  return lista;
}

function salvarSaboresAdmin(lista) {
  localStorage.setItem('itap_sabores', JSON.stringify(lista));
  // Atualizar tamb√©m no products.js em mem√≥ria
  if (produtos && produtos.sorvetes) {
    produtos.sorvetes.sabores = lista.filter(s => !s.esgotado).map(s => s.nome);
  }
}

function renderSaboresAdmin() {
  const container = document.getElementById('lista-sabores-admin');
  if (!container) return;
  const lista = getSaboresAdmin();
  container.innerHTML = lista.map((s, i) => `
    <div style="background:${s.esgotado ? '#FEF2F2' : '#F0FDF4'};border:1px solid ${s.esgotado ? '#FECACA' : '#BBF7D0'};border-radius:10px;padding:10px 12px;display:flex;align-items:center;justify-content:space-between;gap:8px">
      <span style="font-size:13px;font-weight:700;color:${s.esgotado ? '#EF4444' : '#111827'};flex:1;${s.esgotado ? 'text-decoration:line-through' : ''}">${s.nome}</span>
      <div style="display:flex;gap:4px;flex-shrink:0">
        <button onclick="toggleEsgotadoSabor(${i})" style="padding:5px 10px;border:none;border-radius:7px;font-size:11px;font-weight:800;cursor:pointer;background:${s.esgotado ? '#10B981' : '#EF4444'};color:#fff">
          ${s.esgotado ? '‚úÖ Ativar' : '‚ùå Esgotar'}
        </button>
        <button onclick="excluirSabor(${i})" style="padding:5px 8px;border:none;border-radius:7px;font-size:11px;font-weight:800;cursor:pointer;background:#6B7280;color:#fff" title="Excluir">üóëÔ∏è</button>
      </div>
    </div>`).join('');
}

function adicionarSabor() {
  const input = document.getElementById('novo-sabor-input');
  const nome = input.value.trim();
  if (!nome) { mostrarStatusSabores('‚ö†Ô∏è Digite o nome do sabor!'); return; }
  const lista = getSaboresAdmin();
  if (lista.find(s => s.nome.toLowerCase() === nome.toLowerCase())) {
    mostrarStatusSabores('‚ö†Ô∏è Sabor j√° existe na lista!'); return;
  }
  lista.push({ nome, esgotado: false });
  salvarSaboresAdmin(lista);
  input.value = '';
  renderSaboresAdmin();
  mostrarStatusSabores('‚úÖ Sabor "' + nome + '" adicionado com sucesso!');
}

function toggleEsgotadoSabor(idx) {
  const lista = getSaboresAdmin();
  lista[idx].esgotado = !lista[idx].esgotado;
  salvarSaboresAdmin(lista);
  renderSaboresAdmin();
  const status = lista[idx].esgotado ? '‚ùå "' + lista[idx].nome + '" marcado como ESGOTADO' : '‚úÖ "' + lista[idx].nome + '" reativado!';
  mostrarStatusSabores(status);
}

function excluirSabor(idx) {
  const lista = getSaboresAdmin();
  const nome = lista[idx].nome;
  if (!confirm('Excluir o sabor "' + nome + '" permanentemente?')) return;
  lista.splice(idx, 1);
  salvarSaboresAdmin(lista);
  renderSaboresAdmin();
  mostrarStatusSabores('üóëÔ∏è "' + nome + '" exclu√≠do permanentemente.');
}

function mostrarStatusSabores(msg) {
  const el = document.getElementById('sabores-status');
  if (el) { el.textContent = msg; setTimeout(() => el.textContent = '', 4000); }
}

// ‚îÄ‚îÄ SALVAR ‚îÄ‚îÄ
function salvarTudo() {
  const msg = document.getElementById('status-msg');
  msg.textContent = '‚åõ Gerando arquivo...';
  const novoJS = '// products.js ‚Äì Atualizado em ' + new Date().toLocaleDateString('pt-BR') + '\nconst produtos = ' + JSON.stringify(produtos, null, 4) + ';\n';
  const blob = new Blob([novoJS], { type: 'text/javascript' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'products.js';
  a.click();
  msg.textContent = '‚úÖ products.js baixado! Envie ao GitHub para aplicar no site.';
  setTimeout(() => msg.textContent = '', 6000);
}
</script>
</body>
</html>
